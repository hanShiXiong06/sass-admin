import{d as j,r as c,n as H,l as S,q as t,h as m,s as _,w as o,a as v,e as i,br as E,i as g,t as V,u as r,R as W,c as F,F as P,T as M,L as K,K as X,ac as $,aD as z,bR as A,M as G,E as J,X as Q,Y as Z}from"./index-904cb7a2.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  */import"./el-form-item-4ed993c7.js";import{e as ee,a as le,b as ae,g as te,c as oe}from"./vip-bf0d5dbc.js";const re={class:"mt-2 mb-2 ml-4"},se=v("span",{class:"text-gray-400"},"留空代表永久有效",-1),ie={class:"dialog-footer"},De=j({__name:"vip-edit",emits:["complete"],setup(de,{expose:R,emit:B}){let d=c(!1);const n=c(!1),y={id:"",member_id:"",level_id:"",over_time:"",member_id_name:""},a=H({...y}),h=c(),C=S(()=>({member_id:[{required:!0,message:t("memberIdPlaceholder"),trigger:"blur"}],level_id:[{required:!0,message:t("levelIdPlaceholder"),trigger:"blur"}],over_time:[{required:!0,message:t("overTimePlaceholder"),trigger:"blur"}]})),T=async u=>{if(n.value||!u)return;let e=a.id?ee:le;await u.validate(async s=>{s&&(n.value=!0,e(a).then(p=>{n.value=!1,d.value=!1,B("complete")}).catch(p=>{n.value=!1}))})},U=()=>{I()},f=c(),w=c([]),I=async()=>{w.value=await(await ae({keyword:f.value})).data.data};I();const k=c([]);return(async()=>{k.value=await(await te({})).data})(),R({showDialog:d,setFormData:async(u=null)=>{if(Object.assign(a,y),n.value=!0,u){const e=await(await oe(u.id)).data;e&&Object.keys(a).forEach(s=>{e[s]!=null&&(a[s]=e[s])})}n.value=!1}}),(u,e)=>{const s=K,L=X,p=$,D=z,Y=A,q=G,x=J,N=Q,O=Z;return m(),_(N,{modelValue:r(d),"onUpdate:modelValue":e[6]||(e[6]=l=>E(d)?d.value=l:d=l),title:a.id?r(t)("updateVip"):r(t)("addVip"),width:"50%",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:o(()=>[v("span",ie,[i(x,{onClick:e[4]||(e[4]=l=>E(d)?d.value=!1:d=!1)},{default:o(()=>[g(V(r(t)("cancel")),1)]),_:1}),i(x,{type:"primary",loading:n.value,onClick:e[5]||(e[5]=l=>T(h.value))},{default:o(()=>[g(V(r(t)("confirm")),1)]),_:1},8,["loading"])])]),default:o(()=>[W((m(),_(q,{model:a,"label-width":"120px",ref_key:"formRef",ref:h,rules:r(C),class:"page-form"},{default:o(()=>[a.id>0?(m(),_(s,{key:0,label:r(t)("memberId")},{default:o(()=>[v("div",null,V(a.member_id_name),1)]),_:1},8,["label"])):(m(),_(s,{key:1,label:r(t)("memberId"),prop:"member_id"},{default:o(()=>[i(D,{class:"input-width",modelValue:a.member_id,"onUpdate:modelValue":e[1]||(e[1]=l=>a.member_id=l),clearable:"",placeholder:r(t)("memberIdPlaceholder")},{default:o(()=>[v("div",re,[i(L,{onChange:U,modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),style:{width:"200px"},placeholder:"搜索会员支持昵称/会员名"},{append:o(()=>[g("搜索 ")]),_:1},8,["modelValue"])]),i(p,{label:"请选择",value:""}),(m(!0),F(P,null,M(w.value,(l,b)=>(m(),_(p,{key:b,label:l.nickname,value:l.member_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])),i(s,{label:r(t)("levelId"),prop:"level_id"},{default:o(()=>[i(D,{class:"input-width",modelValue:a.level_id,"onUpdate:modelValue":e[2]||(e[2]=l=>a.level_id=l),clearable:"",placeholder:r(t)("levelIdPlaceholder")},{default:o(()=>[i(p,{label:"请选择",value:""}),(m(!0),F(P,null,M(k.value,(l,b)=>(m(),_(p,{key:b,label:l.level_name,value:l.level_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),i(s,{label:r(t)("overTime"),class:"input-width"},{default:o(()=>[i(Y,{class:"flex-1 !flex",style:{width:"480px"},modelValue:a.over_time,"onUpdate:modelValue":e[3]||(e[3]=l=>a.over_time=l),clearable:"",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:r(t)("overTimePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(s,null,{default:o(()=>[se]),_:1})]),_:1},8,["model","rules"])),[[O,n.value]])]),_:1},8,["modelValue","title"])}}});export{De as _};
