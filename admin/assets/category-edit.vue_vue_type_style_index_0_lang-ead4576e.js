import{d as O,r as m,q as R,m as j,s as o,h as c,v as g,w as r,a as T,e as t,i as E,t as F,u as s,R as $,c as D,F as k,T as x,K as A,L as K,ab as X,aC as Y,aS as z,M as H,E as J,X as Q,Y as W}from"./index-0e396751.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                  */import Z from"./index-11d71036.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import"./el-form-item-4ed993c7.js";import{r as ee,t as ae,v as le,a as oe,w as te}from"./goods-4d7d064c.js";const re={class:"dialog-footer"},Ee=O({__name:"category-edit",emits:["complete"],setup(se,{expose:L,emit:N}){const p=m(!1),n=m(!1),f=m(""),y={category_id:"",category_name:"",image:"",pid:0,is_show:1,child_count:0,memory_group:"",level:1},l=R({...y}),v=m(),b=m([]),P=j(()=>({category_id:[{required:!0,message:o("categoryIdPlaceholder"),trigger:"blur"}],category_name:[{required:!0,message:o("categoryNamePlaceholder"),trigger:"blur"}],pid:[{required:!0,message:o("pidPlaceholder"),trigger:"change"}]})),h=m([]),U=async i=>{if(n.value||!i)return;const e=l.category_id?ee:ae;await i.validate(async d=>{d&&(n.value=!0,e(l).then(_=>{n.value=!1,p.value=!1,N("complete")}).catch(_=>{n.value=!1}))})},B=()=>{oe({level:1}).then(i=>{h.value=i.data.filter(e=>e.category_id!=l.category_id),w()})},w=()=>{te().then(i=>{b.value=i.data})};return L({showDialog:p,setFormData:async(i=null)=>{if(Object.assign(l,y),n.value=!0,i){f.value=o("updateCategory");const e=await(await le(i.category_id)).data;e&&Object.keys(l).forEach(d=>{e[d]!=null&&(l[d]=e[d])})}else f.value=o("addCategory");B(),w(),n.value=!1}}),(i,e)=>{const d=A,u=K,_=X,V=Y,G=Z,S=z,q=H,C=J,I=Q,M=W;return c(),g(I,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value=a),title:f.value,width:"480",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:r(()=>[T("span",re,[t(C,{onClick:e[5]||(e[5]=a=>p.value=!1)},{default:r(()=>[E(F(s(o)("cancel")),1)]),_:1}),t(C,{type:"primary",loading:n.value,onClick:e[6]||(e[6]=a=>U(v.value))},{default:r(()=>[E(F(s(o)("confirm")),1)]),_:1},8,["loading"])])]),default:r(()=>[$((c(),g(q,{model:l,"label-width":"120px",ref_key:"formRef",ref:v,rules:s(P),class:"page-form"},{default:r(()=>[t(u,{label:s(o)("categoryName"),prop:"category_name"},{default:r(()=>[t(d,{modelValue:l.category_name,"onUpdate:modelValue":e[0]||(e[0]=a=>l.category_name=a),modelModifiers:{trim:!0},clearable:"",placeholder:s(o)("categoryNamePlaceholder"),class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(u,{label:s(o)("pid"),prop:"pid"},{default:r(()=>[t(V,{modelValue:l.pid,"onUpdate:modelValue":e[1]||(e[1]=a=>l.pid=a),clearable:"",disabled:!!l.child_count,placeholder:s(o)("pidPlaceholder"),class:"input-width"},{default:r(()=>[t(_,{label:"顶级分类",value:0}),(c(!0),D(k,null,x(h.value,a=>(c(),g(_,{key:a.category_id,label:a.category_name,value:a.category_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),t(u,{label:s(o)("image")},{default:r(()=>[t(G,{modelValue:l.image,"onUpdate:modelValue":e[2]||(e[2]=a=>l.image=a)},null,8,["modelValue"])]),_:1},8,["label"]),t(u,{label:s(o)("memoryGroup")},{default:r(()=>[t(V,{modelValue:l.memory_group,"onUpdate:modelValue":e[3]||(e[3]=a=>l.memory_group=a),clearable:"",placeholder:s(o)("memoryGroupPlaceholder"),class:"input-width"},{default:r(()=>[(c(!0),D(k,null,x(b.value.data,a=>(c(),g(_,{key:a.group_id,label:a.group_name,value:a.group_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(u,{label:s(o)("isShow"),prop:"is_show"},{default:r(()=>[t(S,{modelValue:l.is_show,"onUpdate:modelValue":e[4]||(e[4]=a=>l.is_show=a),class:"input-width","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[M,n.value]])]),_:1},8,["modelValue","title"])}}});export{Ee as _};
