import{d as E,r as i,y as I,f as R,m as S,q as B,h as f,c as V,R as D,v as F,w as s,e as t,a as c,i as _,t as N,u as g,s as A,B as q,U as $,aW as J,a7 as L,E as M,L as O,M as U,Y as T}from"./index-0e396751.js";/* empty css                   *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  *//* empty css                *//* empty css                 */import{d as W}from"./goods-90826154.js";import{_ as Y}from"./index.vue_vue_type_style_index_0_lang-b97fa5d8.js";/* empty css                  *//* empty css                    *//* empty css                 */const j={class:"main-container"},z={class:"flex"},G={class:"v-[320px]"},H={class:"flex"},ce=E({__name:"upload_price",setup(K){const v=i(!1);(()=>{let e="00",o="-1";localStorage.getItem("admin.userinfo")&&(e=JSON.parse(localStorage.getItem("admin.userinfo")).uid),localStorage.getItem("site.userinfo")&&(o=JSON.parse(localStorage.getItem("site.userinfo")).uid),e===o&&(v.value=!0)})();const x=I(),y=R();x.meta.title,i();const a=i(!1),m=i(),h=()=>{const e=document.createElement("a");e.href=q("addon/goods_export/file/goods.xlsx"),e.target="_blank",e.download="goods.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)},b=S(()=>({file_url:[{required:!0,message:"请上传文件",trigger:"blur"}],goods_category:[{required:!0,message:"商品分类必须选择",trigger:"blur"}]})),l=B({...{file_url:""}}),k=async e=>{a.value||!e||await e.validate(async o=>{if(o){a.value=!0;const r=l;console.log(r),W(r).then(n=>{a.value=!1,$({message:"正在奋力导入，请稍后进入商品列表查看",type:"success"})}).catch(()=>{a.value=!1,y.push("/site_spdr/shop/goods/upload_price")})}})};return(e,o)=>{const r=J,n=L,u=M,p=O,w=U,C=T;return f(),V("div",j,[D((f(),F(w,{"element-loading-text":"正在导入数据......",model:l,"label-width":"140px",ref_key:"formRef",ref:m,rules:g(b),class:"page-form"},{default:s(()=>[t(n,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[t(n,{class:"!border-none",shadow:"never",style:{width:"640px"}},{default:s(()=>[t(r,{type:"info",title:"说明:请按照模板格式导入xlsx文件，格式不正确会导入失败,暂未适配多规格,如要和其他平台数据进行批量导入，请适配正常格式才能执行成功。本操作需要确保队列正常运行。上传文件为临时文件，不长时存储，单次导入不超过50条，如需单次更多条数导入请联系管理员导入",closable:!1,"show-icon":""})]),_:1}),c("div",z,[t(u,{loading:a.value,class:"mb-6 ml-6",type:"primary",plain:"",onClick:o[0]||(o[0]=d=>h())},{default:s(()=>[_(" 下载模板 ")]),_:1},8,["loading"])]),t(p,{label:"上传文件",prop:"file_url"},{default:s(()=>[c("div",G,[t(Y,{modelValue:l.file_url,"onUpdate:modelValue":o[1]||(o[1]=d=>l.file_url=d),api:"sys/document/applet"},null,8,["modelValue"])])]),_:1}),t(p,{label:"",prop:""},{default:s(()=>[c("div",H,[t(u,{type:"primary",loading:a.value,onClick:o[2]||(o[2]=d=>k(m.value))},{default:s(()=>[_(N(g(A)("confirm")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[C,a.value]])])}}});export{ce as default};
