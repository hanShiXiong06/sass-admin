import{d as F,r as s,aJ as M,h as g,c as C,e as t,w as l,F as L,T as N,v as $,i as w,a as c,U as j,a5 as J,ab as O,aC as W,L as q,E as G,M as H,a7 as K,ac as Q,aS as R,ad as X,W as Y,p as Z,g as ee}from"./index-0e396751.js";/* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                        *//* empty css                *//* empty css                *//* empty css                  */import"./el-form-item-4ed993c7.js";import{j as te,k as ae,l as oe,m as le,n as ne}from"./site-368fa7aa.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";const E=d=>(Z("data-v-27c54501"),d=d(),ee(),d),ie={class:"site-agent-config"},re=E(()=>c("div",{class:"card-header"},[c("span",null,"添加代理关系")],-1)),ce=E(()=>c("div",{class:"card-header"},[c("span",null,"代理关系列表")],-1)),de={class:"mt-4 text-right"},_e=F({__name:"config",setup(d){const n=s({agent_site_id:void 0}),v=s([]),f=s([]),_=s(1),p=s(20),h=s(0),u=async()=>{try{const e=await te();e.code===1&&(v.value=e.data||[])}catch(e){console.error("获取可代理站点失败:",e)}},i=async()=>{try{const e=await ae({page:_.value,limit:p.value});e.code===1&&(f.value=e.data.data||[],h.value=e.data.total||0)}catch(e){console.error("获取代理列表失败:",e)}},x=async()=>{if(!n.value.agent_site_id){j.warning("请选择要代理的站点");return}try{(await oe({agent_site_id:n.value.agent_site_id})).code===1&&(n.value.agent_site_id=void 0,i(),u())}catch(e){console.error("添加代理失败:",e)}},V=async e=>{try{const o=await le({id:e.id,status:e.status})}catch(o){console.error("修改状态失败:",o),e.status=e.status===1?0:1}},k=async e=>{try{await J.confirm("确定要删除该代理关系吗?","提示",{type:"warning"}),(await ne(e)).code===1&&(i(),u())}catch(o){o!=="cancel"&&console.error("删除失败:",o)}},z=e=>{p.value=e,i()},A=e=>{_.value=e,i()};return M(()=>{u(),i()}),(e,o)=>{const B=O,I=W,b=q,y=G,U=H,S=K,r=Q,P=R,T=X,D=Y;return g(),C("div",ie,[t(S,{class:"box-card"},{header:l(()=>[re]),default:l(()=>[t(U,{model:n.value,"label-width":"120px"},{default:l(()=>[t(b,{label:"选择代理站点"},{default:l(()=>[t(I,{modelValue:n.value.agent_site_id,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value.agent_site_id=a),placeholder:"请选择要代理的站点"},{default:l(()=>[(g(!0),C(L,null,N(v.value,a=>(g(),$(B,{key:a.site_id,label:a.site_name,value:a.site_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(b,null,{default:l(()=>[t(y,{type:"primary",onClick:x},{default:l(()=>[w("添加代理")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(S,{class:"box-card"},{header:l(()=>[ce]),default:l(()=>[t(T,{data:f.value,style:{width:"100%"}},{default:l(()=>[t(r,{prop:"id",label:"ID",width:"80"}),t(r,{prop:"site_name",label:"站点名称"}),t(r,{prop:"status",label:"状态",width:"120"},{default:l(({row:a})=>[t(P,{modelValue:a.status,"onUpdate:modelValue":m=>a.status=m,"active-value":1,"inactive-value":0,onChange:m=>V(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(r,{prop:"create_time",label:"创建时间",width:"180"}),t(r,{label:"操作",width:"120"},{default:l(({row:a})=>[t(y,{type:"danger",link:"",onClick:m=>k(a.id)},{default:l(()=>[w(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",de,[t(D,{currentPage:_.value,"onUpdate:currentPage":o[1]||(o[1]=a=>_.value=a),pageSize:p.value,"onUpdate:pageSize":o[2]||(o[2]=a=>p.value=a),total:h.value,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next",onSizeChange:z,onCurrentChange:A},null,8,["currentPage","pageSize","total"])])]),_:1})])}}});const Ie=se(_e,[["__scopeId","data-v-27c54501"]]);export{Ie as default};
