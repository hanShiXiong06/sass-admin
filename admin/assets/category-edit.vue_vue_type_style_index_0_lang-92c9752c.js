import{d as q,r as c,q as B,m as I,s as a,h as y,v as w,w as s,a as P,e as i,i as b,t as h,u as n,R,K as S,L as U,aS as k,M,E as j,X as L,Y as O}from"./index-0e396751.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                 */import{e as T,a as K,g as X}from"./category-e2645452.js";const Y={class:"dialog-footer"},le=q({__name:"category-edit",emits:["complete"],setup(z,{expose:V,emit:E}){const u=c(!1),r=c(!1),p=c(""),g={category_id:"",category_name:"",status:1,sort:""},t=B({...g}),f=c(),x={required:/[\S]+/,number:/^\d{0,10}$/,digit:/^\d{0,10}(.?\d{0,2})$/,special:/^\d{0,10}(.?\d{0,3})$/},C=I(()=>({category_id:[{required:!0,message:a("categoryIdPlaceholder"),trigger:"blur"}],category_name:[{required:!0,message:a("categoryNamePlaceholder"),trigger:"blur"}],sort:[{trigger:"blur",validator:(d,e,o)=>{isNaN(e)||!x.number.test(e)?o(new Error(a("sortTips"))):o()}}]})),D=async d=>{if(r.value||!d)return;const e=t.category_id?T:K;await d.validate(async o=>{o&&(r.value=!0,e(t).then(_=>{r.value=!1,u.value=!1,E("complete")}).catch(()=>{r.value=!1}))})};return V({showDialog:u,setFormData:async(d=null)=>{if(Object.assign(t,g),r.value=!0,d){p.value=a("updateCategory");const e=await(await X(d.category_id)).data;e&&Object.keys(t).forEach(o=>{e[o]!=null&&(t[o]=e[o])})}else p.value=a("addCategory");r.value=!1}}),(d,e)=>{const o=S,m=U,_=k,N=M,v=j,F=L,$=O;return y(),w(F,{modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=l=>u.value=l),title:p.value,width:"480",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:s(()=>[P("span",Y,[i(v,{onClick:e[3]||(e[3]=l=>u.value=!1)},{default:s(()=>[b(h(n(a)("cancel")),1)]),_:1}),i(v,{type:"primary",loading:r.value,onClick:e[4]||(e[4]=l=>D(f.value))},{default:s(()=>[b(h(n(a)("confirm")),1)]),_:1},8,["loading"])])]),default:s(()=>[R((y(),w(N,{model:t,"label-width":"120px",ref_key:"formRef",ref:f,rules:n(C),class:"page-form"},{default:s(()=>[i(m,{label:n(a)("categoryName"),prop:"category_name"},{default:s(()=>[i(o,{modelValue:t.category_name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.category_name=l),modelModifiers:{trim:!0},clearable:"",placeholder:n(a)("categoryNamePlaceholder"),class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(m,{label:n(a)("sort"),prop:"sort"},{default:s(()=>[i(o,{modelValue:t.sort,"onUpdate:modelValue":e[1]||(e[1]=l=>t.sort=l),modelModifiers:{trim:!0},clearable:"",placeholder:n(a)("sortPlaceholder"),class:"input-width",maxlength:"8"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i(m,{label:n(a)("status"),prop:"status"},{default:s(()=>[i(_,{modelValue:t.status,"onUpdate:modelValue":e[2]||(e[2]=l=>t.status=l),class:"input-width","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[$,r.value]])]),_:1},8,["modelValue","title"])}}});export{le as _};
