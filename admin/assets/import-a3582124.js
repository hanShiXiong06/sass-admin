import{d as R,r as d,y as q,f as D,m as I,q as U,h as c,c as g,R as M,v as b,w as o,e,a as p,i as x,F as N,T as $,t as S,u as y,s as T,B as W,U as A,aW as O,a7 as Y,E as j,L as z,ab as G,aC as H,M as J,Y as K}from"./index-0e396751.js";/* empty css                   *//* empty css                *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                  *//* empty css                *//* empty css                 */import{i as P}from"./config-13083706.js";import{_ as Q}from"./index.vue_vue_type_style_index_0_lang-d5a38a62.js";import{g as X}from"./user-cf8803de.js";/* empty css                  *//* empty css                    */const Z={class:"main-container"},ee={class:"flex"},te={class:"v-[320px]"},ae={class:"flex"},ke=R({__name:"import",setup(oe){const _=d([]);(async()=>{_.value=await(await X({})).data})();const h=q(),w=D();h.meta.title,d();const s=d(!1),f=d(),C=()=>{const t=document.createElement("a");t.href=W("addon/qf_notice/file/member.xlsx"),t.target="_blank",t.download="会员管理列表.xlsx",document.body.appendChild(t),t.click(),document.body.removeChild(t)},k=I(()=>({file_url:[{required:!0,message:"请上传文件",trigger:"blur"}],cat_id:[{required:!0,message:"请选择分类",trigger:"blur"}]})),r=U({...{file_url:"",cat_id:""}}),E=async t=>{s.value||!t||await t.validate(async a=>{if(a){s.value=!0;const n=r;console.log(n),P(n).then(m=>{s.value=!1,A({message:"正在处理导入数据，请稍后刷新用户列表",type:"success"});const i="/qf_notice/user/user";w.push(i)}).catch(()=>{s.value=!1})}})};return(t,a)=>{const n=O,m=Y,i=j,u=z,v=G,V=H,F=J,L=K;return c(),g("div",Z,[M((c(),b(F,{"element-loading-text":"正在导入数据......",model:r,"label-width":"140px",ref_key:"formRef",ref:f,rules:y(k),class:"page-form"},{default:o(()=>[e(m,{class:"box-card !border-none",shadow:"never"},{default:o(()=>[e(m,{class:"!border-none",shadow:"never",style:{width:"640px"}},{default:o(()=>[e(n,{type:"info",title:"说明:请按照模板格式导入xlsx文件，格式不正确会导入失败；执行后请刷新用户列表，后台依次处理上传的xlsx文件",closable:!1,"show-icon":""})]),_:1}),p("div",ee,[e(i,{loading:s.value,class:"mb-6 ml-6",type:"primary",plain:"",onClick:a[0]||(a[0]=l=>C())},{default:o(()=>[x(" 下载模板 ")]),_:1},8,["loading"])]),e(u,{label:"上传文件",prop:"file_url"},{default:o(()=>[p("div",te,[e(Q,{modelValue:r.file_url,"onUpdate:modelValue":a[1]||(a[1]=l=>r.file_url=l),api:"sys/document/applet"},null,8,["modelValue"])])]),_:1}),e(u,{label:"选择分类",prop:"cat_id"},{default:o(()=>[e(V,{class:"input-width",modelValue:r.cat_id,"onUpdate:modelValue":a[2]||(a[2]=l=>r.cat_id=l),clearable:"",placeholder:"请选择分类"},{default:o(()=>[e(v,{label:"请选择",value:""}),(c(!0),g(N,null,$(_.value,(l,B)=>(c(),b(v,{key:B,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"",prop:""},{default:o(()=>[p("div",ae,[e(i,{type:"primary",loading:s.value,onClick:a[3]||(a[3]=l=>E(f.value))},{default:o(()=>[x(S(y(T)("confirm")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[L,s.value]])])}}});export{ke as default};
