import{d as H,f as J,x as X,r as g,n as Z,bO as ee,a2 as te,h as T,c as ae,e as n,w as s,a as m,t as i,u as r,i as u,q as l,R as ne,s as le,bP as oe,a5 as P,U as B,aq as se,E as re,K as ie,L as de,M as ce,a7 as me,aw as pe,ad as ue,al as _e,a1 as ge,aa as fe,ae as he,W as be,Y as ke}from"./index-904cb7a2.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{M as ve,N as xe,O as ye,P as Ce,Q as we}from"./marketing-fa4978d8.js";const Ee={class:"main-container"},Te={class:"flex justify-between items-center"},Pe={class:"text-page-title"},Be={class:"mb-[10px] flex items-center"},Re={style:{display:"inline-flex","align-items":"center"}},Se={class:"mr-[5px]"},Ve={class:"mt-[16px] flex justify-end"},Xe=H({__name:"list",setup(Ne){const v=J(),R=X().meta.title,h=g(!1),x=g(),e=Z({page:1,limit:10,total:0,loading:!1,data:[],searchParam:{name:"",order:"",sort:""}}),c=(t=1)=>{e.loading=!0,e.page=t,ve({page:e.page,limit:e.limit,...e.searchParam}).then(a=>{e.loading=!1,e.data=a.data.data,e.total=a.data.total,oe(e.page,e.limit,e.searchParam)}).catch(()=>{e.loading=!1})};c(ee(e.searchParam).page);const S=t=>{t&&(t.resetFields(),e.searchParam.name="",c())},V=()=>{v.push("/shop/marketing/goods_rank/edit")},N=t=>{v.push("/shop/marketing/goods_rank/edit?rank_id="+t.rank_id)},$=t=>{t.status=t.status===1?0:1;const a={rank_id:t.rank_id,status:t.status};xe(a)},z=t=>{P.confirm(l("deleteTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{ye(t).then(()=>{c()})})},D=t=>{let a="";t.order=="ascending"?a="asc":t.order=="descending"&&(a="desc"),a&&(e.searchParam.order=t.prop,e.searchParam.sort=a),c()},b=g(),k=g(!1),F=t=>{k.value=!1,y.value.toggleAllSelection()},y=g(),_=g([]),L=t=>{_.value=t,b.value=!1,_.value.length>0&&_.value.length<e.data.length?k.value=!0:k.value=!1,_.value.length==e.data.length&&(b.value=!0)},U=()=>{if(_.value.length==0){B({type:"warning",message:`${l("batchEmptySelectedGoodsTips")}`});return}P.confirm(l("batchGoodsDeleteTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{if(h.value)return;h.value=!0;const t=[];_.value.forEach(a=>{t.push(a.rank_id)}),Ce({rank_id:t}).then(()=>{c(),h.value=!1}).catch(()=>{h.value=!1})})},G={number:/^\d{0,10}$/,digit:/^\d{0,10}(.?\d{0,2})$/},I=se((t,a)=>{if(isNaN(t)||!G.number.test(t)){B({type:"warning",message:`${l("sortTips")}`});return}t>99999999&&(a.sort=99999999),we({rank_id:a.rank_id,sort:t}).then(p=>{c()})});return(t,a)=>{const p=re,C=ie,w=de,M=ce,E=me,j=pe,d=ue,Q=_e,q=te("QuestionFilled"),O=ge,A=fe,K=he,W=be,Y=ke;return T(),ae("div",Ee,[n(E,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[m("div",Te,[m("span",Pe,i(r(R)),1),n(p,{type:"primary",onClick:V},{default:s(()=>[u(i(r(l)("addRanking")),1)]),_:1})]),n(E,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:s(()=>[n(M,{inline:!0,model:e.searchParam,ref_key:"searchFormRef",ref:x},{default:s(()=>[n(w,{label:r(l)("rankName"),prop:"rankName"},{default:s(()=>[n(C,{modelValue:e.searchParam.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.searchParam.name=o),modelModifiers:{trim:!0},placeholder:r(l)("rankNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(w,null,{default:s(()=>[n(p,{type:"primary",onClick:a[1]||(a[1]=o=>c())},{default:s(()=>[u(i(r(l)("search")),1)]),_:1}),n(p,{onClick:a[2]||(a[2]=o=>S(x.value))},{default:s(()=>[u(i(r(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),m("div",null,[m("div",Be,[n(j,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=o=>b.value=o),size:"large",class:"px-[14px]",onChange:F,indeterminate:k.value},null,8,["modelValue","indeterminate"]),n(p,{onClick:U,size:"small"},{default:s(()=>[u(i(r(l)("batchDeletion")),1)]),_:1})]),ne((T(),le(K,{data:e.data,size:"large",ref_key:"goodBankListTableRef",ref:y,onSortChange:D,onSelectionChange:L},{empty:s(()=>[m("span",null,i(e.loading?"":r(l)("emptyData")),1)]),default:s(()=>[n(d,{type:"selection",width:"55"}),n(d,{prop:"name",label:r(l)("rankName"),"min-width":"130"},null,8,["label"]),n(d,{prop:"show_goods_num",label:r(l)("showGoodsNum"),"min-width":"130"},null,8,["label"]),n(d,{prop:"goods_source_name",label:r(l)("goodsSource"),"min-width":"130"},null,8,["label"]),n(d,{prop:"rule_type_name",label:r(l)("ruleType"),"min-width":"130"},null,8,["label"]),n(d,{prop:"rank_type_name",label:r(l)("rankType"),"min-width":"130"},null,8,["label"]),n(d,{prop:"status",label:r(l)("isShow"),width:"130"},{default:s(({row:o})=>[n(Q,{class:"cursor-pointer",type:o.status!=0?"success":"danger",onClick:f=>$(o)},{default:s(()=>[u(i(o.status!=0?"开启":"关闭"),1)]),_:2},1032,["type","onClick"])]),_:1},8,["label"]),n(d,{prop:"sort","min-width":"120","show-overflow-tooltip":!0,sortable:"custom"},{header:s(()=>[m("div",Re,[m("span",Se,i(r(l)("sort")),1),n(A,{class:"box-item",effect:"light",content:r(l)("sortRules"),placement:"top"},{default:s(()=>[n(O,{color:"#666"},{default:s(()=>[n(q)]),_:1})]),_:1},8,["content"])])]),default:s(({row:o})=>[n(C,{modelValue:o.sort,"onUpdate:modelValue":f=>o.sort=f,modelModifiers:{number:!0},class:"w-[70px]",maxlength:"8",onBlur:f=>r(I)(o.sort,o)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:1}),n(d,{prop:"create_time",label:r(l)("createTime"),"min-width":"150",sortable:"custom"},{default:s(({row:o})=>[m("div",null,i(o.create_time),1)]),_:1},8,["label"]),n(d,{label:r(l)("operation"),fixed:"right",align:"right","min-width":"120"},{default:s(({row:o})=>[n(p,{type:"primary",link:"",onClick:f=>N(o)},{default:s(()=>[u(i(r(l)("edit")),1)]),_:2},1032,["onClick"]),n(p,{type:"primary",link:"",onClick:f=>z(o.rank_id)},{default:s(()=>[u(i(r(l)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[Y,e.loading]]),m("div",Ve,[n(W,{"current-page":e.page,"onUpdate:current-page":a[4]||(a[4]=o=>e.page=o),"page-size":e.limit,"onUpdate:page-size":a[5]||(a[5]=o=>e.limit=o),layout:"total, sizes, prev, pager, next, jumper",total:e.total,onSizeChange:a[6]||(a[6]=o=>c()),onCurrentChange:c},null,8,["current-page","page-size","total"])])])]),_:1})])}}});export{Xe as default};
