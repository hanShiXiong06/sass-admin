import{d as q,f as G,x as K,r as v,n as W,bO as Y,h as s,c,e as n,w as l,a as u,t as i,u as o,i as _,q as t,F as T,T as A,s as y,R as H,B as k,bP as J,a5 as B,E as Q,K as X,L as Z,ac as ee,aD as te,M as ae,a7 as ne,ad as le,ae as oe,W as se,Y as ie}from"./index-904cb7a2.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{l as re,m as pe,n as ce,o as de}from"./marketing-fa4978d8.js";import{_ as ue}from"./coupon-spread-popup.vue_vue_type_script_setup_true_lang-283d1dd6.js";/* empty css                  *//* empty css                   *//* empty css                 *//* empty css                        */import"./browser-a1ac24ac.js";const me={class:"main-container"},_e={class:"flex justify-between items-center"},he={class:"text-page-title"},fe={class:"mt-[10px]"},ye={key:0},ge={key:1},be={key:0},ve={key:1},ke={key:0},Ce={key:1},xe={key:0},Ee={key:1},Pe={key:1},Te={key:0},Be={key:0,class:"flex flex-col"},Fe={key:1},Se={key:1},Ve={class:"mt-[16px] flex justify-end"},lt=q({__name:"list",setup(Le){const g=G(),F=K().meta.title,C=v(null),a=W({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",status:""}}),x=v();(()=>{re().then(r=>{C.value=r.data})})();const h=(r=1)=>{a.loading=!0,a.page=r,pe({page:a.page,limit:a.limit,...a.searchParam}).then(p=>{a.loading=!1,a.data=p.data.data,a.total=p.data.total,J(a.page,a.limit,a.searchParam)}).catch(()=>{a.loading=!1})};h(Y(a.searchParam).page);const E=v(null),S=r=>{E.value.show(r)},V=()=>{g.push("/shop/marketing/coupon/add")},L=r=>{g.push("/shop/marketing/coupon/edit?id="+r.id)},$=r=>{g.push("/shop/marketing/coupon/collection?id="+r.id)},N=r=>{B.confirm(t("couponDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{ce(r.id).then(()=>{h()}).catch(()=>{})})},R=r=>{B.confirm(t("couponColseTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{de(r.id).then(()=>{h()}).catch(()=>{})})},z=r=>{r&&(r.resetFields(),h())};return(r,p)=>{const m=Q,D=X,b=Z,I=ee,U=te,j=ae,P=ne,d=le,w=oe,M=se,O=ie;return s(),c("div",me,[n(P,{class:"box-card !border-none",shadow:"never"},{default:l(()=>[u("div",_e,[u("span",he,i(o(F)),1),n(m,{type:"primary",onClick:V},{default:l(()=>[_(i(o(t)("addCoupon")),1)]),_:1})]),n(P,{class:"box-card !border-none my-[20px] table-search-wrap",shadow:"never"},{default:l(()=>[n(j,{inline:!0,model:a.searchParam,ref_key:"searchFormRef",ref:x},{default:l(()=>[n(b,{label:o(t)("title"),prop:"title"},{default:l(()=>[n(D,{modelValue:a.searchParam.title,"onUpdate:modelValue":p[0]||(p[0]=e=>a.searchParam.title=e),modelModifiers:{trim:!0},placeholder:o(t)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(b,{label:o(t)("statusName"),prop:"status"},{default:l(()=>[n(U,{modelValue:a.searchParam.status,"onUpdate:modelValue":p[1]||(p[1]=e=>a.searchParam.status=e),clearable:"",class:"input-item"},{default:l(()=>[(s(!0),c(T,null,A(C.value,(e,f)=>(s(),y(I,{key:f,label:e,value:f},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(b,null,{default:l(()=>[n(m,{type:"primary",onClick:p[2]||(p[2]=e=>h())},{default:l(()=>[_(i(o(t)("search")),1)]),_:1}),n(m,{onClick:p[3]||(p[3]=e=>z(x.value))},{default:l(()=>[_(i(o(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),u("div",fe,[H((s(),y(w,{data:a.data,size:"large"},{empty:l(()=>[u("span",null,i(a.loading?"":o(t)("emptyData")),1)]),default:l(()=>[n(d,{prop:"title",label:o(t)("title"),"min-width":"130"},null,8,["label"]),n(d,{prop:"type_name",label:o(t)("type"),"min-width":"98"},null,8,["label"]),n(d,{prop:"price",label:o(t)("price"),"min-width":"100"},{default:l(({row:e})=>[u("span",null,"¥"+i(e.price),1)]),_:1},8,["label"]),n(d,{label:o(t)("receiveType"),"min-width":"130"},{default:l(({row:e})=>[e.receive_type==1?(s(),c("span",ye,"是")):(s(),c("span",ge,"否"))]),_:1},8,["label"]),n(d,{label:o(t)("sumCount"),"min-width":"160"},{default:l(({row:e})=>[e.receive_type==1&&e.sum_count!="-1"?(s(),c("span",be,i(e.remain_count||0)+" / "+i(e.sum_count||0),1)):(s(),c("span",ve,"不限量"))]),_:1},8,["label"]),n(d,{label:o(t)("remainCount"),"min-width":"140"},{default:l(({row:e})=>[u("span",null,i(e.receive_count||0)+" / "+i(e.receive_use_count||0),1)]),_:1},8,["label"]),n(d,{label:o(t)("threshold"),"min-width":"130"},{default:l(({row:e})=>[e.min_condition_money=="0.00"?(s(),c("span",ke,"无门槛")):(s(),c("span",Ce,"满"+i(e.min_condition_money)+"元可用",1))]),_:1},8,["label"]),n(d,{label:o(t)("validType"),"min-width":"190"},{default:l(({row:e})=>[e.receive_type==1?(s(),c(T,{key:0},[e.valid_type==1?(s(),c("span",xe," 领取之日起"+i(e.length||"")+" 天内有效",1)):(s(),c("span",Ee," 使用截止时间至"+i(e.valid_end_time||""),1))],64)):(s(),c("span",Pe,"--"))]),_:1},8,["label"]),n(d,{label:o(t)("receiveTypeTime"),"min-width":"210"},{default:l(({row:e})=>[e.receive_type==1?(s(),c("div",Te,[parseInt(e.start_time)!=0&&parseInt(e.end_time)!=0?(s(),c("div",Be,[u("span",null,"开始时间："+i(e.start_time),1),u("span",null,"结束时间："+i(e.end_time),1)])):(s(),c("div",Fe,"不限时"))])):(s(),c("span",Se,"--"))]),_:1},8,["label"]),n(d,{prop:"status_name",label:o(t)("statusName"),"min-width":"98"},null,8,["label"]),n(d,{label:o(t)("operation"),fixed:"right",align:"right","min-width":"160"},{default:l(({row:e})=>[n(m,{type:"primary",link:"",onClick:f=>S(e)},{default:l(()=>[_(i(o(t)("spreadGoods")),1)]),_:2},1032,["onClick"]),e.status==0||e.status==1?(s(),y(m,{key:0,type:"primary",link:"",onClick:f=>L(e)},{default:l(()=>[_(i(o(t)("edit")),1)]),_:2},1032,["onClick"])):k("",!0),e.status!=1?(s(),y(m,{key:1,type:"primary",link:"",onClick:f=>N(e)},{default:l(()=>[_(i(o(t)("delete")),1)]),_:2},1032,["onClick"])):k("",!0),e.status==1?(s(),y(m,{key:2,type:"primary",link:"",onClick:f=>R(e)},{default:l(()=>[_(i(o(t)("close")),1)]),_:2},1032,["onClick"])):k("",!0),n(m,{type:"primary",link:"",onClick:f=>$(e)},{default:l(()=>[_(i(o(t)("receive")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[O,a.loading]]),u("div",Ve,[n(M,{"current-page":a.page,"onUpdate:current-page":p[4]||(p[4]=e=>a.page=e),"page-size":a.limit,"onUpdate:page-size":p[5]||(p[5]=e=>a.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:p[6]||(p[6]=e=>h()),onCurrentChange:h},null,8,["current-page","page-size","total"])])])]),_:1}),n(ue,{ref_key:"couponSpreadPopupRef",ref:E},null,512)])}}});export{lt as default};
