import{d as U,f as $,y as q,r as _,q as I,m as j,s as a,h as v,c as T,e as s,w as i,u as o,aP as F,R as S,v as R,i as g,t as h,a as b,C as D,bU as G,aQ as K,a7 as L,K as Z,L as H,aS as O,M as Q,E as Y,Y as z}from"./index-0e396751.js";/* empty css                   *//* empty css                  *//* empty css                *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                *//* empty css                   *//* empty css                       */import{j as A,k as J,l as W}from"./recharge-ed2a2547.js";import{_ as X}from"./package-gift.vue_vue_type_script_setup_true_lang-a99d4be5.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";const ae={class:"main-container"},te={class:"fixed-footer-wrap"},re={class:"fixed-footer"},le=U({__name:"edit",setup(oe){const N=$(),k=q(),n=_(!1),u=k.query.recharge_id,t=I({recharge_id:0,recharge_name:"",face_value:"",buy_price:"",sort:"",status:1,gift_json:{}});_({});const V=_(null),w=_(),y={required:/[\S]+/,number:/^\d{0,10}$/,digit:/^\d{0,10}(.?\d{0,2})$/,special:/^\d{0,10}(.?\d{0,3})$/},P=j(()=>({recharge_name:[{required:!0,message:a("namePlaceholder"),trigger:"blur"}],face_value:[{required:!0,trigger:"blur",validator:(d,e,l)=>{e===null||e===""?l(a("faceValuePlaceholder")):isNaN(e)||!y.digit.test(e)?l(a("limitTips")):e<=0?l(a("faceValueMustBeGreaterThanZero")):l()}}],buy_price:[{required:!0,trigger:"blur",validator:(d,e,l)=>{e===null||e===""?l(a("pricePlaceholder")):isNaN(e)||!y.digit.test(e)?l(a("limitTips")):e<=0?l(a("priceMustBeGreaterThanZero")):l()}}]}));(()=>{if(u){n.value=!0;let d={recharge_id:Number(u)};A(d).then(e=>{const l=e.data;l&&(Object.assign(t,l),n.value=!1)})}})();const E=async()=>{var d;await((d=w.value)==null?void 0:d.validate(async e=>{var l;if(e){if(!await((l=V.value)==null?void 0:l.verify()))return;n.value=!0,u?(t.recharge_id=Number(u),J(t).then(p=>{n.value=!1,c()}).catch(()=>{n.value=!1})):W(t).then(p=>{n.value=!1,c()}).catch(()=>{n.value=!1})}}))},c=()=>{N.push("/recharge/package/list")};return(d,e)=>{const l=K,p=L,f=Z,m=H,B=O,C=Q,x=Y,M=z;return v(),T("div",ae,[s(p,{class:"box-card !border-none",shadow:"never"},{default:i(()=>[s(l,{content:o(u)?o(a)("editRecharge"):o(a)("addRecharge"),icon:o(F),onBack:e[0]||(e[0]=r=>c())},null,8,["content","icon"])]),_:1}),S((v(),R(p,{class:"box-card mt-[15px] !border-none",shadow:"never"},{default:i(()=>[s(C,{model:t,"label-width":"120px",ref_key:"formRef",ref:w,rules:o(P),class:"page-form"},{default:i(()=>[s(m,{label:o(a)("rechargeName"),prop:"recharge_name"},{default:i(()=>[s(f,{modelValue:t.recharge_name,"onUpdate:modelValue":e[1]||(e[1]=r=>t.recharge_name=r),modelModifiers:{trim:!0},clearable:"",placeholder:o(a)("namePlaceholder"),class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(m,{label:o(a)("faceValue"),prop:"face_value"},{default:i(()=>[s(f,{modelValue:t.face_value,"onUpdate:modelValue":e[2]||(e[2]=r=>t.face_value=r),modelModifiers:{trim:!0},clearable:"",placeholder:"0.00",class:"input-width-short",maxlength:"5"},{append:i(()=>[g(h(o(a)("yuan")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(m,{label:o(a)("price"),prop:"buy_price"},{default:i(()=>[s(f,{modelValue:t.buy_price,"onUpdate:modelValue":e[3]||(e[3]=r=>t.buy_price=r),modelModifiers:{trim:!0},clearable:"",placeholder:"0.00",class:"input-width-short",maxlength:"5"},{append:i(()=>[g(h(o(a)("yuan")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),b("div",null,[n.value?D("",!0):(v(),R(X,{key:0,ref_key:"giftRef",ref:V,modelValue:t.gift_json,"onUpdate:modelValue":e[4]||(e[4]=r=>t.gift_json=r)},null,8,["modelValue"]))]),s(m,{label:o(a)("sort"),prop:"sort"},{default:i(()=>[s(f,{modelValue:t.sort,"onUpdate:modelValue":e[5]||(e[5]=r=>t.sort=r),modelModifiers:{number:!0},clearable:"",placeholder:"0",class:"input-width-short",maxlength:"8",onKeyup:e[6]||(e[6]=r=>o(G)(r)),onBlur:e[7]||(e[7]=r=>t.sort=r.target.value),"show-word-limit":""},null,8,["modelValue"])]),_:1},8,["label"]),s(m,{label:o(a)("status"),prop:"status"},{default:i(()=>[s(B,{modelValue:t.status,"onUpdate:modelValue":e[8]||(e[8]=r=>t.status=r),class:"input-width","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})),[[M,n.value]]),b("div",te,[b("div",re,[s(x,{type:"primary",onClick:e[9]||(e[9]=r=>E())},{default:i(()=>[g(h(o(a)("save")),1)]),_:1}),s(x,{onClick:e[10]||(e[10]=r=>c())},{default:i(()=>[g(h(o(a)("cancel")),1)]),_:1})])])])}}});const Ve=ee(le,[["__scopeId","data-v-283acea8"]]);export{Ve as default};
