import{d as ce,y as fe,f as ye,q as D,m as G,s as l,r as h,bO as ge,h as p,c as v,e as o,w as n,a as w,t as d,u as a,i as m,F as U,T as B,v as b,R as _e,C as $,bP as he,a5 as J,E as ve,K as be,L as we,ab as Pe,aC as ke,M as Ve,a7 as Ce,ac as xe,ad as Te,W as De,X as Ee,ax as Ue,ay as $e,Y as Fe}from"./index-0e396751.js";/* empty css                   */import Se from"./index-11d71036.js";/* empty css                    *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{j as Re,k as Be,l as Ne,m as Ae,n as Ie,o as qe,p as ze}from"./diy-e7cda029.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-d82568af.js";import"./attachment-c52133c7.js";import"./index.vue_vue_type_script_setup_true_lang-34f8a01a.js";/* empty css                 *//* empty css               *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                    */import"./el-dropdown-item-4ed993c7.js";import"./index.vue_vue_type_script_setup_true_lang-077a27b1.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-5014406f.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./sortable.esm-be94e56d.js";const Me={class:"main-container"},Le={class:"flex justify-between items-center"},je={class:"text-page-title"},Oe={key:0},Ye={key:0,class:"text-primary"},Ge={key:1},Je={class:"mt-[16px] flex justify-end"},Ke={class:"dialog-footer"},We={class:"dialog-footer"},Bl=ce({__name:"list",setup(Xe){const K=fe(),F=ye(),W=K.meta.title,V=D({}),g=D({title:"",type:""}),X=G(()=>({title:[{required:!0,message:l("titlePlaceholder"),trigger:"blur"}],type:[{required:!0,message:l("pageTypePlaceholder"),trigger:"blur"}]})),N=h(),C=h(!1),H=async r=>{r&&await r.validate(async e=>{if(e){const s={type:g.type,title:g.title},P=F.resolve({path:"/decorate/edit",query:s});window.open(P.href),C.value=!1,g.title="",g.type=""}})},A=(r="")=>{Be({mode:"",addon:r}).then(e=>{for(let s in V)delete V[s];for(const s in e.data)V[s]=e.data[s]})};A();const I=D({});Re().then(r=>{if(r.data)for(const e in r.data)I[e]=r.data[e]});const Q=r=>{i.searchParam.type="",A(r)},i=D({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",type:"",mode:"",addon_name:""}}),q=h(),_=(r=1)=>{i.loading=!0,i.page=r,Ne({page:i.page,limit:i.limit,...i.searchParam}).then(e=>{i.loading=!1,i.data=e.data.data,i.total=e.data.total,he(i.page,i.limit,i.searchParam)}).catch(()=>{i.loading=!1})};_(ge(i.searchParam).page);const Z=r=>{const e=F.resolve({path:"/decorate/edit",query:{id:r.id}});window.open(e.href)},ee=r=>{Ae({id:r}).then(()=>{_()})},E=h(!1),le=r=>{J.confirm(l("diyPageCopyTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{E.value||(E.value=!0,Ie({id:r}).then(e=>{e.code==1&&_(),E.value=!1}).catch(e=>{E.value=!1}))})},te=r=>{J.confirm(l("diyPageDeleteTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{qe(r).then(()=>{_()}).catch(()=>{})})},ae=r=>{const e=F.resolve({path:"/preview/wap",query:{page:r.type_page+"?id="+r.id}});window.open(e.href)},c=h("wechat"),z=h(""),M=h(0),f=D({wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}}),x=h(!1),oe=G(()=>({})),L=h(),ne=async r=>{M.value=r.id,z.value=r.title;const e=r.share?JSON.parse(r.share):{wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}};e&&(f.wechat=e.wechat,f.weapp=e.weapp),x.value=!0},re=async r=>{r&&await r.validate(async e=>{e&&ze({id:M.value,share:JSON.stringify(f)}).then(()=>{_(),x.value=!1}).catch(()=>{})})},ie=r=>{r&&(r.resetFields(),_())};return(r,e)=>{const s=ve,P=be,y=we,T=Pe,S=ke,R=Ve,j=Ce,k=xe,se=Te,de=De,O=Ee,Y=Ue,pe=$e,ue=Se,me=Fe;return p(),v("div",Me,[o(j,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[w("div",Le,[w("span",je,d(a(W)),1),o(s,{type:"primary",class:"w-[100px]",onClick:e[0]||(e[0]=t=>C.value=!0)},{default:n(()=>[m(d(a(l)("addDiyPage")),1)]),_:1})]),o(j,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[o(R,{inline:!0,model:i.searchParam,ref_key:"searchFormDiyPageRef",ref:q},{default:n(()=>[o(y,{label:a(l)("title"),prop:"title"},{default:n(()=>[o(P,{modelValue:i.searchParam.title,"onUpdate:modelValue":e[1]||(e[1]=t=>i.searchParam.title=t),modelModifiers:{trim:!0},placeholder:a(l)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(y,{label:a(l)("forAddon"),prop:"addon_name"},{default:n(()=>[o(S,{modelValue:i.searchParam.addon_name,"onUpdate:modelValue":e[2]||(e[2]=t=>i.searchParam.addon_name=t),placeholder:a(l)("forAddonPlaceholder"),onChange:Q},{default:n(()=>[o(T,{label:a(l)("all"),value:""},null,8,["label"]),(p(!0),v(U,null,B(I,(t,u)=>(p(),b(T,{label:t.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(y,{label:a(l)("typeName"),prop:"type"},{default:n(()=>[o(S,{modelValue:i.searchParam.type,"onUpdate:modelValue":e[3]||(e[3]=t=>i.searchParam.type=t),placeholder:a(l)("pageTypePlaceholder")},{default:n(()=>[o(T,{label:a(l)("all"),value:""},null,8,["label"]),(p(!0),v(U,null,B(V,(t,u)=>(p(),b(T,{label:t.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(y,null,{default:n(()=>[o(s,{type:"primary",onClick:e[4]||(e[4]=t=>_())},{default:n(()=>[m(d(a(l)("search")),1)]),_:1}),o(s,{onClick:e[5]||(e[5]=t=>ie(q.value))},{default:n(()=>[m(d(a(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),_e((p(),b(se,{data:i.data,size:"large"},{empty:n(()=>[w("span",null,d(i.loading?"":a(l)("emptyData")),1)]),default:n(()=>[o(k,{prop:"page_title",label:a(l)("title"),"min-width":"120"},null,8,["label"]),o(k,{prop:"addon_name",label:a(l)("forAddon"),"min-width":"80"},null,8,["label"]),o(k,{prop:"type_name",label:a(l)("typeName"),"min-width":"80"},null,8,["label"]),o(k,{label:a(l)("status"),"min-width":"80"},{default:n(({row:t})=>[t.type=="DIY_PAGE"?(p(),v("span",Oe,"-")):(p(),v(U,{key:1},[t.is_default==1?(p(),v("span",Ye,d(a(l)("isUse")),1)):(p(),v("span",Ge,d(a(l)("unused")),1))],64))]),_:1},8,["label"]),o(k,{prop:"update_time",label:a(l)("updateTime"),"min-width":"120"},null,8,["label"]),o(k,{label:a(l)("operation"),fixed:"right",align:"right","min-width":"160"},{default:n(({row:t})=>[o(s,{type:"primary",link:"",onClick:u=>ae(t)},{default:n(()=>[m(d(a(l)("preview")),1)]),_:2},1032,["onClick"]),t.is_default==0?(p(),b(s,{key:0,type:"primary",link:"",onClick:u=>ee(t.id)},{default:n(()=>[m(d(a(l)("use")),1)]),_:2},1032,["onClick"])):$("",!0),t.type=="DIY_PAGE"?(p(),b(s,{key:1,type:"primary",link:"",onClick:u=>ne(t)},{default:n(()=>[m(d(a(l)("shareSet")),1)]),_:2},1032,["onClick"])):$("",!0),o(s,{type:"primary",link:"",onClick:u=>Z(t)},{default:n(()=>[m(d(a(l)("edit")),1)]),_:2},1032,["onClick"]),t.is_default==0||t.type=="DIY_PAGE"?(p(),b(s,{key:2,type:"primary",link:"",onClick:u=>te(t.id)},{default:n(()=>[m(d(a(l)("delete")),1)]),_:2},1032,["onClick"])):$("",!0),o(s,{type:"primary",link:"",onClick:u=>le(t.id)},{default:n(()=>[m(d(a(l)("copy")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[me,i.loading]]),w("div",Je,[o(de,{"current-page":i.page,"onUpdate:current-page":e[6]||(e[6]=t=>i.page=t),"page-size":i.limit,"onUpdate:page-size":e[7]||(e[7]=t=>i.limit=t),layout:"total, sizes, prev, pager, next, jumper",total:i.total,onSizeChange:e[8]||(e[8]=t=>_()),onCurrentChange:_},null,8,["current-page","page-size","total"])])]),_:1}),o(O,{modelValue:C.value,"onUpdate:modelValue":e[13]||(e[13]=t=>C.value=t),title:a(l)("addPageTips"),width:"350px"},{footer:n(()=>[w("span",Ke,[o(s,{onClick:e[11]||(e[11]=t=>C.value=!1)},{default:n(()=>[m(d(a(l)("cancel")),1)]),_:1}),o(s,{type:"primary",onClick:e[12]||(e[12]=t=>H(N.value))},{default:n(()=>[m(d(a(l)("confirm")),1)]),_:1})])]),default:n(()=>[o(R,{model:g,"label-width":"90px",ref_key:"formRef",ref:N,rules:a(X)},{default:n(()=>[o(y,{label:a(l)("title"),prop:"title"},{default:n(()=>[o(P,{modelValue:g.title,"onUpdate:modelValue":e[9]||(e[9]=t=>g.title=t),modelModifiers:{trim:!0},placeholder:a(l)("titlePlaceholder"),clearable:"",maxlength:"12","show-word-limit":"",class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(y,{label:a(l)("typeName"),prop:"type"},{default:n(()=>[o(S,{modelValue:g.type,"onUpdate:modelValue":e[10]||(e[10]=t=>g.type=t),placeholder:a(l)("pageTypePlaceholder"),class:"!w-full"},{default:n(()=>[(p(!0),v(U,null,B(V,(t,u)=>(p(),b(T,{label:t.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),o(O,{modelValue:x.value,"onUpdate:modelValue":e[20]||(e[20]=t=>x.value=t),title:a(l)("shareSet"),width:"30%"},{footer:n(()=>[w("span",We,[o(s,{onClick:e[18]||(e[18]=t=>x.value=!1)},{default:n(()=>[m(d(a(l)("cancel")),1)]),_:1}),o(s,{type:"primary",onClick:e[19]||(e[19]=t=>re(L.value))},{default:n(()=>[m(d(a(l)("confirm")),1)]),_:1})])]),default:n(()=>[o(pe,{modelValue:c.value,"onUpdate:modelValue":e[14]||(e[14]=t=>c.value=t)},{default:n(()=>[o(Y,{label:a(l)("wechat"),name:"wechat"},null,8,["label"]),o(Y,{label:a(l)("weapp"),name:"weapp"},null,8,["label"])]),_:1},8,["modelValue"]),o(R,{model:f[c.value],"label-width":"90px",ref_key:"shareFormRef",ref:L,rules:a(oe)},{default:n(()=>[o(y,{label:a(l)("sharePage")},{default:n(()=>[w("span",null,d(z.value),1)]),_:1},8,["label"]),o(y,{label:a(l)("shareTitle"),prop:"title"},{default:n(()=>[o(P,{modelValue:f[c.value].title,"onUpdate:modelValue":e[15]||(e[15]=t=>f[c.value].title=t),modelModifiers:{trim:!0},placeholder:a(l)("shareTitlePlaceholder"),clearable:"",maxlength:"30","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),c.value=="wechat"?(p(),b(y,{key:0,label:a(l)("shareDesc"),prop:"desc"},{default:n(()=>[o(P,{modelValue:f[c.value].desc,"onUpdate:modelValue":e[16]||(e[16]=t=>f[c.value].desc=t),modelModifiers:{trim:!0},placeholder:a(l)("shareDescPlaceholder"),type:"textarea",rows:"4",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):$("",!0),o(y,{label:a(l)("shareImageUrl"),prop:"url"},{default:n(()=>[o(ue,{modelValue:f[c.value].url,"onUpdate:modelValue":e[17]||(e[17]=t=>f[c.value].url=t),limit:1},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Bl as default};
