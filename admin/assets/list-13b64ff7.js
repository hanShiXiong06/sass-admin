import{d as we,y as Te,f as Ee,r as u,q as B,bO as Ve,m as K,s as e,h as _,c as F,e as a,w as s,a as p,t as c,u as l,i as d,R as Pe,v as h,B as De,C as x,a3 as Re,bP as $e,a5 as R,U as W,E as Se,K as Be,L as Fe,ab as Ue,aC as ze,M as Ne,a7 as Ae,ax as Ie,ay as Me,av as Le,ac as je,J as qe,ad as Oe,W as Je,X as Ke,Y as We}from"./index-0e396751.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        *//* empty css                        *//* empty css                    *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{_ as H}from"./default_img-44957769.js";import{b as Xe,c as Ye,d as X,o as Y,f as G}from"./content-6035851c.js";import{c as Ge}from"./comment-91fc331d.js";import{_ as He}from"./content-detail.vue_vue_type_style_index_0_lang-8e0e9482.js";/* empty css                  *//* empty css               *//* empty css               */import"./member_head-d9fd7b2c.js";const Qe={class:"main-container"},Ze={class:"flex justify-between items-center"},et={class:"text-page-title"},tt={class:"mb-[10px] flex items-center"},at={class:"mt-[10px]"},nt={class:"min-w-[70px] h-[70px]"},lt=p("div",{class:"image-slot"},[p("img",{class:"w-[70px] h-[70px]",src:H})],-1),ot={key:1,class:"w-[70px] h-[70px]",src:H,fit:"contain"},st={key:0},it={class:"mt-[16px] flex justify-end"},rt={class:"dialog-footer"},ct={class:"dialog-footer"},Ot=we({__name:"list",setup(dt){const U=Te(),z=Ee(),Q=U.meta.title,V=u(!1),N=u(""),i=B({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{topic_id:"",content_title:"",content_type:"",status:""}});i.searchParam.topic_id=U.query.topic_id;const Z=o=>{i.searchParam.status=o,m()},A=u(),P=u(),D=u(!1),ee=o=>{D.value=!1,I.value.toggleAllSelection()},I=u(),g=u([]),te=o=>{g.value=o,P.value=!1,g.value.length>0&&g.value.length<i.data.length?D.value=!0:D.value=!1,g.value.length==i.data.length&&i.data.length&&g.value.length&&(P.value=!0)},m=(o=1)=>{i.loading=!0,i.page=o;const t=Re(i.searchParam);Xe({page:i.page,limit:i.limit,...i.searchParam}).then(r=>{i.loading=!1,i.data=r.data.data,i.total=r.data.total,$e(i.page,i.limit,t)}).catch(()=>{i.loading=!1})};m(Ve(i.searchParam).page);const M=u([]);(()=>{Ye().then(o=>{M.value=[];for(const t in o.data){const r={name:o.data[t],value:t};M.value.push(r)}})})();const ae=()=>{z.push("/sow_community/content/add")},ne=o=>{z.push("/sow_community/content/edit?content_id="+o.content_id)},le=o=>{R.confirm(e("contentDeleteTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{X({content_ids:[o]}).then(()=>{m()}).catch(()=>{})})},oe=()=>{if(g.value.length==0){W({type:"warning",message:`${e("batchEmptySelectedContentTips")}`});return}const o=[];g.value.forEach(t=>{o.push(t.content_id)}),Y({content_ids:o}).then(t=>{m()})},se=()=>{if(g.value.length==0){W({type:"warning",message:`${e("batchEmptySelectedContentTips")}`});return}R.confirm(e("batchContentDeleteTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{if(V.value)return;V.value=!0;const o=[];g.value.forEach(t=>{o.push(t.content_id)}),X({content_ids:o}).then(()=>{m(),V.value=!1}).catch(()=>{V.value=!1})})},ie=o=>{o&&(o.resetFields(),m())},re=o=>{R.confirm(e("auditAdoptTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{G({content_id:o,status:2}).then(()=>{m()}).catch(()=>{})})},v=u(!1),b=B({...{content_id:0,refuse_reason:"",status:-1}}),L=u(),ce=o=>{b.content_id=o,b.refuse_reason="",v.value=!0},de=K(()=>({refuse_reason:[{required:!0,message:e("refuseReasonPlaceholder"),trigger:"blur"}]})),me=async o=>{o&&await o.validate(async t=>{t&&G(b).then(w=>{m(),v.value=!1}).catch(()=>{v.value=!1})})},$=u(),ue=o=>{const t={id:o.content_id};$.value.setFormData(t),$.value.showDialog=!0},pe=o=>{R.confirm(e("contentOffTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{Y({content_ids:[o]}).then(()=>{m()}).catch(()=>{})})},y=u(!1),C=B({...{content_id:0,comment_content:""}}),j=u(),fe=o=>{C.content_id=o,C.comment_content="",y.value=!0},_e=K(()=>({comment_content:[{required:!0,message:e("commentContentPlaceholder"),trigger:"blur"}]})),ge=async o=>{o&&await o.validate(async t=>{t&&Ge(C).then(w=>{m(),y.value=!1}).catch(()=>{y.value=!1})})};return(o,t)=>{const r=Se,w=Be,T=Fe,q=Ue,he=ze,S=Ne,O=Ae,E=Ie,ve=Me,be=Le,f=je,ye=qe,Ce=Oe,ke=Je,J=Ke,xe=We;return _(),F("div",Qe,[a(O,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[p("div",Ze,[p("span",et,c(l(Q)),1),a(r,{type:"primary",onClick:ae},{default:s(()=>[d(c(l(e)("addContent")),1)]),_:1})]),a(O,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:s(()=>[a(S,{inline:!0,model:i.searchParam,ref_key:"searchFormRef",ref:A},{default:s(()=>[a(T,{label:l(e)("contentTitle"),prop:"content_title"},{default:s(()=>[a(w,{modelValue:i.searchParam.content_title,"onUpdate:modelValue":t[0]||(t[0]=n=>i.searchParam.content_title=n),modelModifiers:{trim:!0},placeholder:l(e)("contentTitlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(T,{label:l(e)("contentType"),prop:"content_type"},{default:s(()=>[a(he,{modelValue:i.searchParam.content_type,"onUpdate:modelValue":t[1]||(t[1]=n=>i.searchParam.content_type=n),placeholder:l(e)("contentTypePlaceholder"),clearable:""},{default:s(()=>[a(q,{label:"图文",value:1}),a(q,{label:"短视频",value:2})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(T,null,{default:s(()=>[a(r,{type:"primary",onClick:t[2]||(t[2]=n=>m())},{default:s(()=>[d(c(l(e)("search")),1)]),_:1}),a(r,{onClick:t[3]||(t[3]=n=>ie(A.value))},{default:s(()=>[d(c(l(e)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(ve,{modelValue:N.value,"onUpdate:modelValue":t[4]||(t[4]=n=>N.value=n),class:"demo-tabs",onTabChange:Z},{default:s(()=>[a(E,{label:l(e)("all"),name:""},null,8,["label"]),a(E,{label:l(e)("auditAdopt"),name:"2"},null,8,["label"]),a(E,{label:l(e)("awaitAudit"),name:"1"},null,8,["label"]),a(E,{label:l(e)("auditRefuse"),name:"-1"},null,8,["label"]),a(E,{label:l(e)("off"),name:"-2"},null,8,["label"])]),_:1},8,["modelValue"]),p("div",tt,[a(be,{modelValue:P.value,"onUpdate:modelValue":t[5]||(t[5]=n=>P.value=n),size:"large",class:"px-[14px]",onChange:ee,indeterminate:D.value},null,8,["modelValue","indeterminate"]),a(r,{onClick:t[6]||(t[6]=n=>oe()),size:"small"},{default:s(()=>[d(c(l(e)("batchOffContent")),1)]),_:1}),a(r,{onClick:se,size:"small"},{default:s(()=>[d(c(l(e)("batchDeleteContent")),1)]),_:1})]),p("div",at,[Pe((_(),h(Ce,{data:i.data,size:"large",ref_key:"contentTableRef",ref:I,onSelectionChange:te},{empty:s(()=>[p("span",null,c(i.loading?"":l(e)("emptyData")),1)]),default:s(()=>[a(f,{type:"selection",width:"55"}),a(f,{label:l(e)("contentCover"),"min-width":"80"},{default:s(({row:n})=>[p("div",nt,[n.content_cover?(_(),h(ye,{key:0,class:"w-[70px] h-[70px]",src:l(De)(n.content_cover),fit:"contain"},{error:s(()=>[lt]),_:2},1032,["src"])):(_(),F("img",ot))])]),_:1},8,["label"]),a(f,{prop:"content_title",label:l(e)("contentTitle"),"min-width":"200"},null,8,["label"]),a(f,{label:l(e)("contentType"),"min-width":"100"},{default:s(({row:n})=>[p("div",null,c(n.content_type==1?"图文":"短视频"),1)]),_:1},8,["label"]),a(f,{label:l(e)("author"),"min-width":"120"},{default:s(({row:n})=>[n.member?(_(),F("div",st,c(n.member.nickname),1)):x("",!0)]),_:1},8,["label"]),a(f,{prop:"view_num",label:l(e)("viewNum"),"min-width":"120"},null,8,["label"]),a(f,{prop:"like_num",label:l(e)("likeNum"),"min-width":"120"},null,8,["label"]),a(f,{prop:"comment_num",label:l(e)("commentNum"),"min-width":"120"},null,8,["label"]),a(f,{prop:"status_name",label:l(e)("status"),"min-width":"120"},null,8,["label"]),a(f,{prop:"create_time",label:l(e)("createTime"),"min-width":"120"},null,8,["label"]),a(f,{label:l(e)("operation"),fixed:"right",align:"right","min-width":"120"},{default:s(({row:n})=>[n.status!=-2?(_(),h(r,{key:0,type:"primary",link:"",onClick:k=>ne(n)},{default:s(()=>[d(c(l(e)("edit")),1)]),_:2},1032,["onClick"])):x("",!0),a(r,{type:"primary",link:"",onClick:k=>le(n.content_id)},{default:s(()=>[d(c(l(e)("delete")),1)]),_:2},1032,["onClick"]),a(r,{type:"primary",link:"",onClick:k=>ue(n)},{default:s(()=>[d(c(l(e)("detail")),1)]),_:2},1032,["onClick"]),n.status==1?(_(),h(r,{key:1,type:"primary",link:"",onClick:k=>re(n.content_id)},{default:s(()=>[d(c(l(e)("adopt")),1)]),_:2},1032,["onClick"])):x("",!0),n.status==1?(_(),h(r,{key:2,type:"primary",link:"",onClick:k=>ce(n.content_id)},{default:s(()=>[d(c(l(e)("refuse")),1)]),_:2},1032,["onClick"])):x("",!0),n.status!=-2?(_(),h(r,{key:3,type:"primary",link:"",onClick:k=>pe(n.content_id)},{default:s(()=>[d(c(l(e)("off")),1)]),_:2},1032,["onClick"])):x("",!0),n.status!=-2?(_(),h(r,{key:4,type:"primary",link:"",onClick:k=>fe(n.content_id)},{default:s(()=>[d(c(l(e)("add")),1)]),_:2},1032,["onClick"])):x("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[xe,i.loading]]),p("div",it,[a(ke,{"current-page":i.page,"onUpdate:current-page":t[7]||(t[7]=n=>i.page=n),"page-size":i.limit,"onUpdate:page-size":t[8]||(t[8]=n=>i.limit=n),layout:"total, sizes, prev, pager, next, jumper",total:i.total,onSizeChange:t[9]||(t[9]=n=>m()),onCurrentChange:m},null,8,["current-page","page-size","total"])])])]),_:1}),a(J,{modelValue:v.value,"onUpdate:modelValue":t[13]||(t[13]=n=>v.value=n),title:l(e)("refuseReason"),width:"460px",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:s(()=>[p("span",rt,[a(r,{onClick:t[11]||(t[11]=n=>v.value=!1)},{default:s(()=>[d(c(l(e)("cancel")),1)]),_:1}),a(r,{type:"primary",onClick:t[12]||(t[12]=n=>me(L.value))},{default:s(()=>[d(c(l(e)("confirm")),1)]),_:1})])]),default:s(()=>[a(S,{model:b,"label-width":"90px",ref_key:"formRef",ref:L,rules:l(de),class:"page-form"},{default:s(()=>[a(T,{label:l(e)("refuseReason"),prop:"refuse_reason"},{default:s(()=>[a(w,{modelValue:b.refuse_reason,"onUpdate:modelValue":t[10]||(t[10]=n=>b.refuse_reason=n),modelModifiers:{trim:!0},type:"textarea",rows:"4",clearable:"",placeholder:l(e)("refuseReasonPlaceholder"),class:"input-width",maxlength:"200","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(J,{modelValue:y.value,"onUpdate:modelValue":t[17]||(t[17]=n=>y.value=n),title:l(e)("commentContent"),width:"460px","destroy-on-close":!0},{footer:s(()=>[p("span",ct,[a(r,{onClick:t[15]||(t[15]=n=>y.value=!1)},{default:s(()=>[d(c(l(e)("cancel")),1)]),_:1}),a(r,{type:"primary",onClick:t[16]||(t[16]=n=>ge(j.value))},{default:s(()=>[d(c(l(e)("confirm")),1)]),_:1})])]),default:s(()=>[a(S,{model:C,"label-width":"90px",ref_key:"formAddRef",ref:j,rules:l(_e),class:"page-form"},{default:s(()=>[a(T,{label:l(e)("commentContent"),prop:"comment_content"},{default:s(()=>[a(w,{modelValue:C.comment_content,"onUpdate:modelValue":t[14]||(t[14]=n=>C.comment_content=n),modelModifiers:{trim:!0},type:"textarea",rows:"4",clearable:"",placeholder:l(e)("commentContentPlaceholder"),class:"input-width",maxlength:"200","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(He,{ref_key:"contentDetailRef",ref:$},null,512)])}}});export{Ot as default};
