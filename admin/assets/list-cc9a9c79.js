import{d as Fe,y as $e,f as Ae,r as f,q as J,bO as Ne,h as p,c as _,e as t,w as i,a as c,t as n,u as s,s as a,F as A,T as Y,v as w,i as y,C as h,R as Me,B as Be,a3 as Q,bP as Ue,a5 as X,U as Z,ab as Oe,aC as Re,K as ze,L as Ye,bR as je,E as Ie,M as Le,a7 as qe,ax as He,ay as Ge,ac as Ke,ad as We,aU as Je,aa as Qe,W as Xe,Y as Ze}from"./index-0e396751.js";/* empty css                   */import{_ as et}from"./index.vue_vue_type_script_setup_true_lang-0825ba66.js";/* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css                    *//* empty css                *//* empty css                *//* empty css                  *//* empty css                       */import"./el-form-item-4ed993c7.js";import{g as tt,a as at,b as lt,c as ot,n as rt,p as st}from"./order-3f7fd991.js";import{p as nt}from"./printer-d56d0ae8.js";import{_ as it}from"./delivery-action.vue_vue_type_style_index_0_lang-f81dccd1.js";import{_ as dt}from"./order-notes.vue_vue_type_style_index_0_lang-462f6341.js";import{_ as pt}from"./order-export-select.vue_vue_type_script_setup_true_lang-98980138.js";import{_ as ct}from"./order-edit-address.vue_vue_type_style_index_0_lang-ff2c662a.js";import{_ as ut}from"./adjust-money.vue_vue_type_style_index_0_lang-b7d688af.js";import{_ as _t}from"./shop-active-refund.vue_vue_type_style_index_0_lang-84d4f3bc.js";import{_ as mt}from"./electronic-sheet-print.vue_vue_type_style_index_0_lang-4b4b163e.js";import{_ as ft}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                  *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                 */import"./delivery-fe1f6e47.js";import"./weapp-aa1cc52a.js";import"./electronic_sheet-29211c03.js";import"./lodop-18d3c062.js";import"./qqmap-011f3cfb.js";const yt={class:"main-container"},ht={class:"flex justify-between items-center"},gt={class:"text-page-title"},vt={key:0,class:"mb-[10px] flex items-center"},bt={class:"table-body min-h-[150px]"},kt={key:0},xt={class:"flex items-center justify-between bg-[#f7f8fa] mt-[10px] border-[#e4e7ed] border-solid border-b-[1px] px-3 h-[35px] text-[12px] text-[#666]"},Ct={class:"ml-5"},wt={key:0,class:"ml-5"},Dt={class:"flex cursor-pointer"},Pt={class:"flex items-center min-w-[50px] mr-[10px]"},St=["src"],Et={key:1,class:"w-[50px] h-[50px]",src:"",alt:""},Tt={class:"flex flex-col items-start"},Vt={class:"max-w-[250px]"},Ft={class:"multi-hidden text-[14px]"},$t={class:"text-[12px] text-[#999] truncate"},At={key:0,class:"px-[4px] text-[12px] text-[#fff] rounded-[4px] bg-primary leading-[18px]"},Nt={class:"flex flex-col"},Mt={key:0},Bt={key:0},Ut={key:1,class:"text-[13px]"},Ot={class:"text-[13px] mt-[5px]"},Rt={class:"flex flex-col cursor-pointer"},zt={key:0,class:"text-[14px]"},Yt={key:0},jt={key:1,class:"text-[14px]"},It={key:2},Lt={class:"flex flex-col"},qt=["onClick"],Ht={class:"text-[12px] mt-[5px]"},Gt={class:"text-[12px] mt-[5px]"},Kt={class:"text-[14px]"},Wt={class:"text-[14px]"},Jt={key:0,class:"text-[14px] min-h-[30px] leading-[30px] px-3 bg-[#fff0e5] text-[#ff7f5b]"},Qt={class:"mr-[5px]"},Xt={class:"mt-[16px] flex justify-end"},Zt=Fe({__name:"list",setup(ea){const N=$e(),j=Ae(),ee=N.meta.title,T=f(N.query.status||""),te=f([]),I=f([]),L=f([]);(async()=>{te.value=await(await tt()).data,I.value=await(await at()).data,L.value=await(await lt()).data})();const x=J({}),V=f(null),S=f(!1),ae=()=>{if(S.value){S.value=!1;for(const l in o.data)V.value[l].clearSelection(),delete x["order_"+o.data[l].order_id]}else{S.value=!0;for(const l in o.data){let r=!1;for(const d in o.data[l].order_goods)o.data[l].order_goods[d].status==1&&(V.value[l].toggleRowSelection(o.data[l].order_goods[d],!0),r=!0);r&&(x["order_"+o.data[l].order_id]=Q(o.data[l]))}}},le=(l,r)=>{let d=!1,g=null;for(let k=0;k<o.data.length;k++)if(o.data[k].order_id==r.order_id){g=o.data[k];break}for(let k=0;k<l.length;k++)if(l[k].order_id==r.order_id){d=!0;break}d?x["order_"+r.order_id]=g:delete x["order_"+r.order_id]},o=J({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{search_type:"order_no",search_name:"",keyword:"",pay_type:"",order_from:"",status:N.query.status||"",create_time:[],pay_time:[]}}),q=f(),b=(l=1)=>{o.loading=!0,o.page=l,ot({page:o.page,limit:o.limit,...o.searchParam}).then(r=>{o.loading=!1,o.data=r.data.data.map(d=>(d.isSupportElectronicSheet=!1,d.isSupportPrintTicket=!1,d.delivery_type=="express"&&d.status==3&&(d.isSupportElectronicSheet=!0),d.delivery_type!="virtual"&&(d.status==2||d.status==3||d.status==5)&&(d.isSupportPrintTicket=!0),d.order_goods.forEach(g=>{g.rowNum=d.order_goods.length}),d)),o.data.forEach((d,g,k)=>{let C=0;d.order_goods.forEach(($,v)=>{$.is_enable_refund==1&&C++}),k[g].is_refund_show=C>0}),o.total=r.data.total,Ue(o.page,o.limit,o.searchParam)}).catch(()=>{o.loading=!1})};b(Ne(o.searchParam).page);const oe=l=>{o.searchParam.status=l,S.value=!1;for(let r in x)delete x[r];b()},re=({row:l,column:r,rowIndex:d,columnIndex:g})=>d===0?g===0?[l.rowNum,1]:g>3?[l.rowNum,1]:[1,1]:g===0?[0,0]:g>3?[0,0]:[1,1],se=f(null),H=f(""),M=f(!1),ne=l=>{M.value=l},ie=l=>{H.value=l,M.value=!0},G=f(null),de=()=>{G.value.showDialog=!0},pe=l=>{j.push("/shop/order/detail?order_id="+l.order_id)},ce=l=>{const r=j.resolve({path:"/member/detail",query:{id:l}});window.open(r.href,"_blank")},ue=l=>{X.confirm(a("orderCloseTips"),a("warning"),{confirmButtonText:a("confirm"),cancelButtonText:a("cancel"),type:"warning"}).then(()=>{rt(l.order_id).then(()=>{b()})})},B=f(null),_e=l=>{B.value.setFormData(l),B.value.showDialog=!0},U=f(null),me=l=>{U.value.setFormData(l),U.value.showDialog=!0},O=f(null),fe=l=>{O.value.setFormData(l),O.value.showDialog=!0},ye=l=>{X.confirm(a("orderFinishTips"),a("warning"),{confirmButtonText:a("confirm"),cancelButtonText:a("cancel"),type:"warning"}).then(()=>{st(l.order_id).then(()=>{b()})})},he=l=>{l&&(l.resetFields(),b())},R=f(null),ge=async l=>{R.value.showDialog=!0,R.value.setFormData(l)},E=f(null),ve=l=>{let r=Q(l);r.print_type="single",E.value.setFormData(r),E.value.showDialog=!0},be=()=>{let l=0,r=[];for(let d in x)x[d].isSupportElectronicSheet?r.push(x[d].order_id):l++;if(l&&r.length==0){Z({type:"warning",message:`${a("notSupportPrintElectronicSheetTips")}`});return}if(r.length==0){Z({type:"warning",message:`${a("batchEmptySelectedOrderTips")}`});return}E.value.setFormData({order_id:r.toString(),print_type:"multiple"}),E.value.showDialog=!0},ke=()=>{S.value=!1;for(const l in o.data)V.value[l].clearSelection(),delete x["order_"+o.data[l].order_id]},F=f(!1),xe=l=>{F.value||(F.value=!0,nt({type:"shopGoodsOrder",trigger:"manual",business:{order_id:l.order_id}}).then(r=>{F.value=!1}).catch(()=>{F.value=!1}))},z=f(null),Ce=l=>{z.value.setFormData(l),z.value.showDialog=!0};return(l,r)=>{const d=Oe,g=Re,k=ze,C=Ye,$=je,v=Ie,we=Le,K=qe,D=He,De=Ge,m=Ke,W=We,Pe=Je,Se=Qe,Ee=Xe,Te=et,Ve=Ze;return p(),_("div",yt,[t(K,{class:"box-card !border-none",shadow:"never"},{default:i(()=>[c("div",ht,[c("span",gt,n(s(ee)),1)]),t(K,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:i(()=>[t(we,{inline:!0,model:o.searchParam,ref_key:"searchFormRef",ref:q},{default:i(()=>[t(C,{label:s(a)("orderInfo"),prop:"search_name"},{default:i(()=>[t(g,{modelValue:o.searchParam.search_type,"onUpdate:modelValue":r[0]||(r[0]=e=>o.searchParam.search_type=e),clearable:"",class:"input-item"},{default:i(()=>[t(d,{label:s(a)("orderNo"),value:"order_no"},null,8,["label"]),t(d,{label:s(a)("outTradeNo"),value:"out_trade_no"},null,8,["label"])]),_:1},8,["modelValue"]),t(k,{class:"input-item ml-3",modelValue:o.searchParam.search_name,"onUpdate:modelValue":r[1]||(r[1]=e=>o.searchParam.search_name=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),t(C,{label:s(a)("memberInfo"),prop:"keyword"},{default:i(()=>[t(k,{class:"w-[200px]",modelValue:o.searchParam.keyword,"onUpdate:modelValue":r[2]||(r[2]=e=>o.searchParam.keyword=e),modelModifiers:{trim:!0},placeholder:s(a)("memberInfoPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(C,{label:s(a)("payType"),prop:"pay_type"},{default:i(()=>[t(g,{modelValue:o.searchParam.pay_type,"onUpdate:modelValue":r[3]||(r[3]=e=>o.searchParam.pay_type=e),clearable:"",class:"input-item"},{default:i(()=>[(p(!0),_(A,null,Y(I.value,(e,P)=>(p(),w(d,{key:P,label:e.name,value:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(C,{label:s(a)("fromType"),prop:"order_from"},{default:i(()=>[t(g,{modelValue:o.searchParam.order_from,"onUpdate:modelValue":r[4]||(r[4]=e=>o.searchParam.order_from=e),clearable:"",class:"input-item"},{default:i(()=>[(p(!0),_(A,null,Y(L.value,(e,P)=>(p(),w(d,{key:P,label:e,value:P},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(C,{label:s(a)("createTime"),prop:"create_time"},{default:i(()=>[t($,{modelValue:o.searchParam.create_time,"onUpdate:modelValue":r[5]||(r[5]=e=>o.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":s(a)("startDate"),"end-placeholder":s(a)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),t(C,{label:s(a)("payTime"),prop:"pay_time"},{default:i(()=>[t($,{modelValue:o.searchParam.pay_time,"onUpdate:modelValue":r[6]||(r[6]=e=>o.searchParam.pay_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":s(a)("startDate"),"end-placeholder":s(a)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),t(C,null,{default:i(()=>[t(v,{type:"primary",onClick:r[7]||(r[7]=e=>b())},{default:i(()=>[y(n(s(a)("search")),1)]),_:1}),t(v,{onClick:r[8]||(r[8]=e=>he(q.value))},{default:i(()=>[y(n(s(a)("reset")),1)]),_:1}),t(v,{type:"primary",onClick:de},{default:i(()=>[y(n(s(a)("export")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(De,{modelValue:T.value,"onUpdate:modelValue":r[9]||(r[9]=e=>T.value=e),class:"demo-tabs",onTabChange:oe},{default:i(()=>[t(D,{label:s(a)("all"),name:""},null,8,["label"]),t(D,{label:s(a)("toBePaid"),name:"1"},null,8,["label"]),t(D,{label:s(a)("toBeShipped"),name:"2"},null,8,["label"]),t(D,{label:s(a)("shipped"),name:"3"},null,8,["label"]),t(D,{label:s(a)("completed"),name:"5"},null,8,["label"]),t(D,{label:s(a)("closed"),name:"-1"},null,8,["label"])]),_:1},8,["modelValue"]),c("div",null,[T.value==3?(p(),_("div",vt,[T.value==3?(p(),w(v,{key:0,onClick:be,size:"small"},{default:i(()=>[y(n(s(a)("batchPrintElectronicSheet")),1)]),_:1})):h("",!0)])):h("",!0),t(W,{data:o.data,size:"large",class:"table-top",onSelectAll:ae},{default:i(()=>[t(m,{type:"selection",width:"40"}),t(m,{label:s(a)("orderGoods"),"min-width":"200"},null,8,["label"]),t(m,{label:s(a)("goodsPriceNumber"),"min-width":"120"},null,8,["label"]),t(m,{label:s(a)("rightsProtection"),"min-width":"120"},null,8,["label"]),t(m,{label:s(a)("orderMoney"),"min-width":"120"},null,8,["label"]),t(m,{label:s(a)("buyInfo"),"min-width":"120"},null,8,["label"]),t(m,{label:s(a)("deliveryType"),"min-width":"100"},null,8,["label"]),t(m,{label:s(a)("orderStatus"),"min-width":"100"},null,8,["label"]),t(m,{label:s(a)("operation"),fixed:"right",align:"right","min-width":"120"},null,8,["label"])]),_:1},8,["data"]),Me((p(),_("div",bt,[o.loading?h("",!0):(p(),_("div",kt,[o.data.length?(p(!0),_(A,{key:0},Y(o.data,(e,P)=>(p(),_("div",{key:P},[c("div",xt,[c("div",null,[c("span",null,n(s(a)("orderNo"))+"："+n(e.order_no),1),c("span",Ct,n(s(a)("createTime"))+"："+n(e.create_time),1),e.pay?(p(),_("span",wt,n(s(a)("payType"))+"："+n(e.pay.type_name),1)):h("",!0)]),c("div",null,[e.isSupportPrintTicket?(p(),w(v,{key:0,type:"primary",link:"",onClick:u=>xe(e)},{default:i(()=>[y(n(s(a)("printTicket")),1)]),_:2},1032,["onClick"])):h("",!0),e.isSupportElectronicSheet?(p(),w(v,{key:1,type:"primary",link:"",onClick:u=>ve(e)},{default:i(()=>[y(n(s(a)("electronicSheetPrintTitle")),1)]),_:2},1032,["onClick"])):h("",!0),t(v,{type:"primary",link:"",onClick:u=>pe(e)},{default:i(()=>[y(n(s(a)("info")),1)]),_:2},1032,["onClick"]),t(v,{type:"primary",link:"",onClick:u=>fe(e)},{default:i(()=>[y(n(s(a)("notes")),1)]),_:2},1032,["onClick"])])]),t(W,{data:e.order_goods,size:"large","show-header":!1,"span-method":re,ref_for:!0,ref_key:"multipleTable",ref:V,onSelect:le},{default:i(()=>[t(m,{type:"selection",width:"40"}),t(m,{align:"left","min-width":"200"},{default:i(({row:u})=>[c("div",Dt,[c("div",Pt,[u.goods_image?(p(),_("img",{key:0,class:"w-[50px] h-[50px]",src:s(Be)(u.goods_image),alt:""},null,8,St)):(p(),_("img",Et))]),c("div",Tt,[t(Pe,{class:"box-item",effect:"light",placement:"top"},{content:i(()=>[c("div",Vt,n(u.goods_name),1)]),default:i(()=>[c("p",Ft,n(u.goods_name),1)]),_:2},1024),c("span",$t,n(u.sku_name),1),u.is_gift==1?(p(),_("span",At,"赠品")):h("",!0)])])]),_:1}),t(m,{"min-width":"120"},{default:i(({row:u})=>[c("div",Nt,[e.activity_type=="exchange"?(p(),_("span",Mt,[y(n(u.extend.point)+n(s(a)("point"))+" ",1),parseFloat(u.price)?(p(),_("span",Bt,"+￥"+n(u.price),1)):h("",!0)])):(p(),_("span",Ut,"￥"+n(u.price),1)),c("span",Ot,n(u.num)+n(s(a)("piece")),1)])]),_:2},1024),t(m,{"min-width":"120"},{default:i(({row:u})=>[c("div",Rt,[c("span",null,n(u.status_name),1)])]),_:1}),t(m,{"min-width":"120","class-name":"border-0 border-l-[1px] border-solid border-[var(--el-table-border-color)]"},{default:i(()=>[e.activity_type=="exchange"?(p(),_("div",zt,[y(n(e.point)+n(s(a)("point"))+" ",1),parseFloat(e.order_money)?(p(),_("span",Yt,"+￥"+n(e.order_money),1)):h("",!0)])):(p(),_("span",jt,"￥"+n(e.order_money),1)),e.pay?(p(),_("div",It,n(e.member_id!==e.pay.main_id&&e.pay.status==2?e.pay.pay_type_name:""),1)):h("",!0)]),_:2},1024),t(m,{"min-width":"120"},{default:i(()=>[c("div",Lt,[c("span",{class:"text-[12px] text-primary cursor-pointer",onClick:u=>ce(e.member.member_id)},n(e.member.nickname),9,qt),c("span",Ht,n(e.taker_name)+" "+n(e.taker_mobile),1),c("span",Gt,n(e.taker_full_address),1)])]),_:2},1024),t(m,{"min-width":"100"},{default:i(()=>[c("span",Kt,n(e.delivery_type_name),1)]),_:2},1024),t(m,{"min-width":"100"},{default:i(()=>[c("span",Wt,n(e.status_name.name),1)]),_:2},1024),t(m,{align:"right","min-width":"120"},{default:i(()=>[e.status==1?(p(),_(A,{key:0},[t(v,{type:"primary",link:"",onClick:u=>ue(e)},{default:i(()=>[y(n(s(a)("orderClose")),1)]),_:2},1032,["onClick"]),t(v,{type:"primary",link:"",onClick:u=>_e(e)},{default:i(()=>[y(n(s(a)("editPrice")),1)]),_:2},1032,["onClick"]),e.delivery_type!="virtual"&&e.activity_type!="giftcard"?(p(),w(v,{key:0,type:"primary",link:"",onClick:u=>ge(e)},{default:i(()=>[y(n(s(a)("editAddress")),1)]),_:2},1032,["onClick"])):h("",!0)],64)):h("",!0),e.status==2?(p(),w(v,{key:1,type:"primary",link:"",onClick:u=>me(e)},{default:i(()=>[y(n(s(a)("sendOutGoods")),1)]),_:2},1032,["onClick"])):h("",!0),e.status==3?(p(),w(v,{key:2,type:"primary",link:"",onClick:u=>ye(e)},{default:i(()=>[y(n(s(a)("confirmTakeDelivery")),1)]),_:2},1032,["onClick"])):h("",!0),e.is_refund_show&&e.status!=1&&e.status!=-1?(p(),w(v,{key:3,type:"primary",link:"",onClick:u=>Ce(e)},{default:i(()=>[y(n(s(a)("voluntaryRefund")),1)]),_:2},1032,["onClick"])):h("",!0)]),_:2},1024)]),_:2},1032,["data"]),e.shop_remark?(p(),_("div",Jt,[c("span",Qt,n(s(a)("notes"))+"：",1),c("span",null,n(e.shop_remark),1)])):h("",!0)]))),128)):(p(),w(Se,{key:1,"image-size":1,description:s(a)("emptyData")},null,8,["description"]))]))])),[[Ve,o.loading]]),c("div",Xt,[t(Ee,{"current-page":o.page,"onUpdate:current-page":r[10]||(r[10]=e=>o.page=e),"page-size":o.limit,"onUpdate:page-size":r[11]||(r[11]=e=>o.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:r[12]||(r[12]=e=>b()),onCurrentChange:b},null,8,["current-page","page-size","total"])])])]),_:1}),t(ut,{ref_key:"orderAdjustMoneyActionDialog",ref:B,onComplete:b},null,512),t(it,{ref_key:"deliveryActionDialog",ref:U,onComplete:b},null,512),t(dt,{ref_key:"orderNotesDialog",ref:O,onComplete:b},null,512),t(pt,{ref_key:"selectExportDialog",ref:G,onComplete:ie},null,512),t(Te,{ref_key:"exportSureDialog",ref:se,show:M.value,type:H.value,searchParam:o.searchParam,onClose:ne},null,8,["show","type","searchParam"]),t(ct,{ref_key:"orderEditAddressDialog",ref:R,onComplete:b},null,512),t(mt,{ref_key:"electronicSheetPrintDialog",ref:E,onComplete:ke},null,512),t(_t,{ref_key:"shopActiveRefundDialog",ref:z,onComplete:b},null,512)])}}});const Ia=ft(Zt,[["__scopeId","data-v-248fc45a"]]);export{Ia as default};
