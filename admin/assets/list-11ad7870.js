import{d as Be,f as Ge,x as Le,r as f,n as V,bO as Ue,a2 as Re,h as p,c as x,e as n,w as r,a as d,t as c,u as l,i as m,q as t,F as z,T as F,s as b,R as w,cb as B,b6 as G,B as C,A as Ie,a5 as L,U as P,aq as De,a3 as Oe,bP as ze,E as Fe,K as Me,L as Ae,bF as Ke,ac as je,aD as qe,M as He,a7 as Je,ay as We,az as Ye,aw as Qe,ad as Xe,J as Ze,a1 as ea,ae as aa,W as ta,Y as oa,p as sa,g as la}from"./index-904cb7a2.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        *//* empty css                        *//* empty css                    *//* empty css                *//* empty css                *//* empty css                          *//* empty css                 */import"./el-form-item-4ed993c7.js";/* empty css                  */import{_ as re}from"./goods_default-664bb559.js";import na from"./goods-member-price-popup-9bdd8895.js";import ra from"./goods-stock-edit-popup-a59b0249.js";import ia from"./goods-price-edit-popup-4715563d.js";import{_ as da}from"./goods-spread-popup.vue_vue_type_script_setup_true_lang-aa5d5770.js";import{g as ca,b as pa,a1 as ua,a2 as ma,a3 as M,a4 as ne,a5 as _a,a6 as ga,a7 as ha}from"./goods-6bf0c95b.js";import{A as fa}from"./member-49c3e5fc.js";import{_ as ba}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                  *//* empty css                   *//* empty css                       */import"./browser-a1ac24ac.js";const A=S=>(sa("data-v-22bf0cc4"),S=S(),la(),S),va={class:"main-container"},ya={class:"flex justify-between items-center"},Pa={class:"text-page-title"},ka={class:"region-input"},xa=["placeholder"],Ca=A(()=>d("span",{class:"separator"},"-",-1)),Ea=["placeholder"],Ta={class:"region-input"},Va=["placeholder"],wa=A(()=>d("span",{class:"separator"},"-",-1)),Sa=["placeholder"],$a={class:"mt-[10px]"},Na={class:"mb-[10px] flex items-center"},Ba=["onClick"],Ga={class:"min-w-[70px] h-[70px] flex items-center justify-center"},La=A(()=>d("div",{class:"image-slot"},[d("img",{class:"w-[70px] h-[70px]",src:re})],-1)),Ua={key:1,class:"w-[70px] h-[70px]",src:re,fit:"contain"},Ra={class:"ml-2 flex flex-col items-start"},Ia=["title"],Da={class:"text-primary text-[12px]"},Oa={key:0,class:"px-[4px] text-[12px] text-[#fff] rounded-[4px] bg-primary leading-[18px]"},za=["onClick"],Fa=["onClick"],Ma={key:0},Aa={key:1},Ka={class:"mt-[16px] flex justify-end"},ja=Be({__name:"list",setup(S){const U=Ge(),K=Le(),ie=K.meta.title,_=f(!1),o=V({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{goods_name:"",goods_category:[],goods_type:"",brand_id:"",label_ids:"",start_sale_num:"",end_sale_num:"",start_price:"",end_price:"",status:K.query.status||"1",order:"",sort:""}}),j=f(),E={number:/^\d{0,10}$/,digit:/^\d{0,10}(.?\d{0,2})$/},R=V([]),q=V([]),H=V([]),J=V([]);(()=>{ca().then(s=>{const a=s.data;if(a){const i=[];i.push({value:"",label:"全部",children:[]}),a.forEach(k=>{const g=[];k.child_list&&(g.push({value:k.category_id,label:"全部"}),k.child_list.forEach(N=>{g.push({value:N.category_id,label:N.category_name})})),i.push({value:k.category_id,label:k.category_name,children:g})}),R.splice(0,R.length,...i)}}),pa().then(s=>{const a=s.data;if(a)for(const i in a)q.push(a[i])}),ua({}).then(s=>{const a=s.data;a&&H.push(...a)}),ma({}).then(s=>{const a=s.data;a&&J.push(...a)})})();const de=(s,a)=>{o.searchParam.status=s.props.name,u()},T=f(),$=f(!1),ce=s=>{$.value=!1,W.value.toggleAllSelection()},W=f(),v=f([]),pe=s=>{v.value=s,T.value=!1,v.value.length>0&&v.value.length<o.data.length?$.value=!0:$.value=!1,v.value.length==o.data.length&&(T.value=!0)},ue=s=>{const a=U.resolve({path:"/preview/wap",query:{page:`/addon/shop/pages/goods/detail?goods_id=${s.goods_id}`}});window.open(a.href)},me=s=>{let a="";s.order=="ascending"?a="asc":s.order=="descending"&&(a="desc"),a&&(o.searchParam.order=s.prop,o.searchParam.sort=a),u()},Y=(s,a)=>{a?M({goods_ids:s.goods_id,status:a}).then(i=>{u()}):L.confirm(t("statusChangeTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{M({goods_ids:s.goods_id,status:a}).then(i=>{u()})})},Q=s=>{if(v.value.length==0){P({type:"warning",message:`${t("batchEmptySelectedGoodsTips")}`});return}const a=[];v.value.forEach(i=>{a.push(i.goods_id)}),M({goods_ids:a,status:s}).then(i=>{u()})},_e=()=>{if(v.value.length==0){P({type:"warning",message:`${t("batchEmptySelectedGoodsTips")}`});return}L.confirm(t("batchGoodsDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{if(_.value)return;_.value=!0;const s=[];v.value.forEach(a=>{s.push(a.goods_id)}),ne({goods_ids:s}).then(()=>{u(),_.value=!1}).catch(()=>{_.value=!1})})},ge=De((s,a)=>{if(isNaN(s)||!E.number.test(s)){P({type:"warning",message:`${t("sortTips")}`});return}s>99999999&&(a.sort=99999999),_a({goods_id:a.goods_id,sort:s}).then(i=>{})}),u=(s=1)=>{if(o.searchParam.start_sale_num&&!E.digit.test(o.searchParam.start_sale_num)){P({type:"warning",message:`${t("startSaleNumTips")}`});return}if(o.searchParam.end_sale_num&&!E.digit.test(o.searchParam.end_sale_num)){P({type:"warning",message:`${t("endSaleNumTips")}`});return}if(Number(o.searchParam.start_sale_num)>Number(o.searchParam.end_sale_num)){P({type:"warning",message:`${t("shopSaleNumTips")}`});return}if(o.searchParam.start_price&&!E.digit.test(o.searchParam.start_price)){P({type:"warning",message:`${t("startPriceTips")}`});return}if(o.searchParam.end_price&&!E.digit.test(o.searchParam.end_price)){P({type:"warning",message:`${t("endPriceTips")}`});return}if(Number(o.searchParam.start_price)>Number(o.searchParam.end_price)){P({type:"warning",message:`${t("shopPriceTips")}`});return}o.loading=!0,o.page=s;const a=Oe(o.searchParam);ga({page:o.page,limit:o.limit,...a}).then(i=>{o.loading=!1,o.data=i.data.data,o.total=i.data.total,v.value=[],T.value=!1,ze(o.page,o.limit,a)}).catch(()=>{o.loading=!1})};u(Ue(o.searchParam).page);const he=()=>{U.push("/shop/goods/real_edit")},fe=s=>{U.push(s.goods_edit_path+"?goods_id="+s.goods_id)},X=f(null),be=s=>{X.value.show(s)},Z=f(null),ve=s=>{Z.value.show(s)},ee=f(null),ye=s=>{ee.value.show(s)},ae=f([]);(()=>{fa().then(s=>{ae.value=s.data?s.data:[]})})();const te=f(null),Pe=s=>{te.value.show(s,ae.value)},ke=s=>{L.confirm(t("goodsCopyTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{_.value||(_.value=!0,ha({goods_id:s.goods_id}).then(a=>{a.code==1&&u(),_.value=!1}).catch(a=>{_.value=!1}))})},xe=s=>{L.confirm(t("goodsDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{_.value||(_.value=!0,ne({goods_ids:s}).then(()=>{u(),_.value=!1}).catch(()=>{_.value=!1}))})},Ce=s=>{s&&(s.resetFields(),o.searchParam.start_price="",o.searchParam.end_price="",o.searchParam.start_sale_num="",o.searchParam.end_sale_num="",u())};return(s,a)=>{const i=Fe,k=Me,g=Ae,N=Ke,I=je,D=qe,Ee=He,oe=Je,O=We,Te=Ye,Ve=Qe,y=Xe,we=Ze,se=Re("EditPen"),le=ea,Se=aa,$e=ta,Ne=oa;return p(),x("div",va,[n(oe,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[d("div",ya,[d("span",Pa,c(l(ie)),1),n(i,{type:"primary",onClick:he},{default:r(()=>[m(c(l(t)("addGoods")),1)]),_:1})]),n(oe,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:r(()=>[n(Ee,{inline:!0,model:o.searchParam,ref_key:"searchFormRef",ref:j},{default:r(()=>[n(g,{label:l(t)("goodsName"),prop:"goods_name"},{default:r(()=>[n(k,{modelValue:o.searchParam.goods_name,"onUpdate:modelValue":a[0]||(a[0]=e=>o.searchParam.goods_name=e),modelModifiers:{trim:!0},placeholder:l(t)("goodsNamePlaceholder"),maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(g,{label:l(t)("goodsCategory"),prop:"goods_category"},{default:r(()=>[n(N,{modelValue:o.searchParam.goods_category,"onUpdate:modelValue":a[1]||(a[1]=e=>o.searchParam.goods_category=e),options:R,placeholder:l(t)("goodsCategoryPlaceholder"),clearable:"",props:{value:"value",label:"label",emitPath:!1}},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),n(g,{label:l(t)("goodsType"),prop:"goods_type"},{default:r(()=>[n(D,{modelValue:o.searchParam.goods_type,"onUpdate:modelValue":a[2]||(a[2]=e=>o.searchParam.goods_type=e),placeholder:l(t)("goodsTypePlaceholder"),clearable:""},{default:r(()=>[(p(!0),x(z,null,F(q,e=>(p(),b(I,{key:e.type,label:e.name,value:e.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(g,{label:l(t)("brand"),prop:"brand_id"},{default:r(()=>[n(D,{modelValue:o.searchParam.brand_id,"onUpdate:modelValue":a[3]||(a[3]=e=>o.searchParam.brand_id=e),placeholder:l(t)("brandPlaceholder"),clearable:""},{default:r(()=>[(p(!0),x(z,null,F(H,e=>(p(),b(I,{key:e.brand_id,label:e.brand_name,value:e.brand_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(g,{label:l(t)("labelIds"),prop:"label_ids"},{default:r(()=>[n(D,{modelValue:o.searchParam.label_ids,"onUpdate:modelValue":a[4]||(a[4]=e=>o.searchParam.label_ids=e),placeholder:l(t)("labelIdsPlaceholder"),clearable:""},{default:r(()=>[(p(!0),x(z,null,F(J,e=>(p(),b(I,{key:e.label_id,label:e.label_name,value:e.label_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(g,{label:l(t)("saleNum"),prop:"sale_num"},{default:r(()=>[d("div",ka,[w(d("input",{type:"text",placeholder:l(t)("startSaleNumPlaceholder"),maxlength:"10","onUpdate:modelValue":a[5]||(a[5]=e=>o.searchParam.start_sale_num=e),onKeyup:a[6]||(a[6]=e=>l(B)(e))},null,40,xa),[[G,o.searchParam.start_sale_num,void 0,{trim:!0}]]),Ca,w(d("input",{type:"text",placeholder:l(t)("endSaleNumPlaceholder"),maxlength:"10","onUpdate:modelValue":a[7]||(a[7]=e=>o.searchParam.end_sale_num=e),onKeyup:a[8]||(a[8]=e=>l(B)(e))},null,40,Ea),[[G,o.searchParam.end_sale_num,void 0,{trim:!0}]])])]),_:1},8,["label"]),n(g,{label:l(t)("skuPrice"),prop:"sku_price"},{default:r(()=>[d("div",Ta,[w(d("input",{type:"text",placeholder:l(t)("startPricePlaceholder"),maxlength:"10","onUpdate:modelValue":a[9]||(a[9]=e=>o.searchParam.start_price=e),onKeyup:a[10]||(a[10]=e=>l(B)(e))},null,40,Va),[[G,o.searchParam.start_price,void 0,{trim:!0}]]),wa,w(d("input",{type:"text",placeholder:l(t)("endPricePlaceholder"),maxlength:"10","onUpdate:modelValue":a[11]||(a[11]=e=>o.searchParam.end_price=e),onKeyup:a[12]||(a[12]=e=>l(B)(e))},null,40,Sa),[[G,o.searchParam.end_price,void 0,{trim:!0}]])])]),_:1},8,["label"]),n(g,null,{default:r(()=>[n(i,{type:"primary",onClick:a[13]||(a[13]=e=>u())},{default:r(()=>[m(c(l(t)("search")),1)]),_:1}),n(i,{onClick:a[14]||(a[14]=e=>Ce(j.value))},{default:r(()=>[m(c(l(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),d("div",$a,[n(Te,{modelValue:o.searchParam.status,"onUpdate:modelValue":a[15]||(a[15]=e=>o.searchParam.status=e),class:"goods-tabs",onTabClick:de},{default:r(()=>[n(O,{label:l(t)("statusOn"),name:"1"},null,8,["label"]),n(O,{label:l(t)("statusOff"),name:"0"},null,8,["label"]),n(O,{label:l(t)("statusAll"),name:""},null,8,["label"])]),_:1},8,["modelValue"]),d("div",Na,[n(Ve,{modelValue:T.value,"onUpdate:modelValue":a[16]||(a[16]=e=>T.value=e),size:"large",class:"px-[14px]",onChange:ce,indeterminate:$.value},null,8,["modelValue","indeterminate"]),o.searchParam.status!="1"?(p(),b(i,{key:0,onClick:a[17]||(a[17]=e=>Q(1)),size:"small"},{default:r(()=>[m(c(l(t)("batchOnGoods")),1)]),_:1})):C("",!0),o.searchParam.status!="0"?(p(),b(i,{key:1,onClick:a[18]||(a[18]=e=>Q(0)),size:"small"},{default:r(()=>[m(c(l(t)("batchOffGoods")),1)]),_:1})):C("",!0),n(i,{onClick:_e,size:"small"},{default:r(()=>[m(c(l(t)("batchDeleteGoods")),1)]),_:1})]),w((p(),b(Se,{data:o.data,size:"large",ref_key:"goodsListTableRef",ref:W,onSortChange:me,onSelectionChange:pe},{empty:r(()=>[d("span",null,c(o.loading?"":l(t)("emptyData")),1)]),default:r(()=>[n(y,{type:"selection",width:"55"}),n(y,{prop:"goods_id",label:l(t)("goodsInfo"),"min-width":"300"},{default:r(({row:e})=>[d("div",{class:"flex items-center cursor-pointer",onClick:h=>ue(e)},[d("div",Ga,[e.goods_cover_thumb_small?(p(),b(we,{key:0,class:"w-[70px] h-[70px]",src:l(Ie)(e.goods_cover_thumb_small),fit:"contain"},{error:r(()=>[La]),_:2},1032,["src"])):(p(),x("img",Ua))]),d("div",Ra,[d("span",{title:e.goods_name,class:"multi-hidden"},c(e.goods_name),9,Ia),d("span",Da,c(e.goods_type_name),1),e.is_gift==1?(p(),x("span",Oa,"赠品")):C("",!0)])],8,Ba)]),_:1},8,["label"]),n(y,{prop:"price",label:l(t)("skuPrice"),"min-width":"120",align:"right",sortable:"custom"},{default:r(({row:e})=>[d("div",{class:"cursor-pointer price-wrap",onClick:h=>be(e)},[d("span",null,"￥"+c(e.goodsSku.price),1),n(le,{class:"icon-wrap ml-[5px] invisible"},{default:r(()=>[n(se)]),_:1})],8,za)]),_:1},8,["label"]),n(y,{prop:"stock",label:l(t)("stock"),"min-width":"120",sortable:"custom"},{default:r(({row:e})=>[d("div",{class:"cursor-pointer stock-wrap",onClick:h=>ve(e)},[d("span",null,c(e.stock),1),n(le,{class:"icon-wrap ml-[5px] invisible"},{default:r(()=>[n(se)]),_:1})],8,Fa)]),_:1},8,["label"]),n(y,{prop:"sale_num",label:l(t)("saleNum"),"min-width":"100",sortable:"custom"},null,8,["label"]),n(y,{prop:"status",label:l(t)("status"),"min-width":"100"},{default:r(({row:e})=>[e.status==1?(p(),x("div",Ma,c(l(t)("statusOn")),1)):C("",!0),e.status==0?(p(),x("div",Aa,c(l(t)("statusOff")),1)):C("",!0)]),_:1},8,["label"]),n(y,{prop:"sort",label:l(t)("sort"),"min-width":"120",sortable:"custom"},{default:r(({row:e})=>[n(k,{modelValue:e.sort,"onUpdate:modelValue":h=>e.sort=h,modelModifiers:{trim:!0},class:"w-[70px]",maxlength:"8",onBlur:h=>l(ge)(e.sort,e)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:1},8,["label"]),n(y,{prop:"create_time",label:l(t)("createTime"),"min-width":"150",sortable:"custom"},{default:r(({row:e})=>[d("div",null,c(e.create_time),1)]),_:1},8,["label"]),n(y,{label:l(t)("operation"),fixed:"right",align:"right","min-width":"120"},{default:r(({row:e})=>[n(i,{type:"primary",link:"",onClick:h=>fe(e)},{default:r(()=>[m(c(l(t)("edit")),1)]),_:2},1032,["onClick"]),n(i,{type:"primary",link:"",onClick:h=>ye(e)},{default:r(()=>[m(c(l(t)("spreadGoods")),1)]),_:2},1032,["onClick"]),n(i,{type:"primary",link:"",onClick:h=>Pe(e)},{default:r(()=>[m(c(l(t)("memberPrice")),1)]),_:2},1032,["onClick"]),e.status==1?(p(),b(i,{key:0,type:"primary",link:"",onClick:h=>Y(e,0)},{default:r(()=>[m(c(l(t)("statusActionOff")),1)]),_:2},1032,["onClick"])):(p(),b(i,{key:1,type:"primary",link:"",onClick:h=>Y(e,1)},{default:r(()=>[m(c(l(t)("statusActionOn")),1)]),_:2},1032,["onClick"])),n(i,{type:"primary",link:"",onClick:h=>ke(e)},{default:r(()=>[m(c(l(t)("copyGoods")),1)]),_:2},1032,["onClick"]),e.status!=1?(p(),b(i,{key:2,type:"primary",link:"",onClick:h=>xe(e.goods_id)},{default:r(()=>[m(c(l(t)("delete")),1)]),_:2},1032,["onClick"])):C("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[Ne,o.loading]]),d("div",Ka,[n($e,{"current-page":o.page,"onUpdate:current-page":a[19]||(a[19]=e=>o.page=e),"page-size":o.limit,"onUpdate:page-size":a[20]||(a[20]=e=>o.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:a[21]||(a[21]=e=>u()),onCurrentChange:u},null,8,["current-page","page-size","total"])])])]),_:1}),n(ra,{ref_key:"goodsStockEditPopupRef",ref:Z,onLoad:u},null,512),n(ia,{ref_key:"goodsPriceEditPopupRef",ref:X,onLoad:u},null,512),n(da,{ref_key:"goodsSpreadPopupRef",ref:ee},null,512),n(na,{ref_key:"memberPricePopupRef",ref:te,onLoad:u},null,512)])}}});const wt=ba(ja,[["__scopeId","data-v-22bf0cc4"]]);export{wt as default};
