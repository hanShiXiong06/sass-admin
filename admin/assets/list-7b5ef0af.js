import{d as G,f as K,y as W,r as g,q as Y,bO as A,h as s,c,e as a,w as l,a as m,t as i,u as o,i as _,s as t,F,T as H,v as y,R as J,C as k,bP as Q,a5 as B,E as X,K as Z,L as ee,ab as te,aC as ae,M as ne,a7 as le,ac as oe,ad as se,W as ie,Y as re}from"./index-0e396751.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{l as pe,m as ce,n as de,o as me}from"./marketing-c0187315.js";import{_ as ue}from"./coupon-spread-popup.vue_vue_type_script_setup_true_lang-5f43e396.js";import{_ as _e}from"./coupon-collection.vue_vue_type_style_index_0_lang-67a8f8ba.js";/* empty css                  *//* empty css                   *//* empty css                 *//* empty css                        */import"./browser-a1ac24ac.js";/* empty css                  *//* empty css               *//* empty css               *//* empty css                     */const fe={class:"main-container"},he={class:"flex justify-between items-center"},ye={class:"text-page-title"},ge={class:"mt-[10px]"},ve={key:0},be={key:1},ke={key:0},Ce={key:1},xe={key:0},Ee={key:1},Pe={key:0},Te={key:1},Fe={key:1},Be={key:0},Se={key:0,class:"flex flex-col"},Ve={key:1},$e={key:1},Le={class:"mt-[16px] flex justify-end"},dt=G({__name:"list",setup(Re){const C=K(),S=W().meta.title,x=g(null),n=Y({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",status:""}}),E=g();(()=>{pe().then(p=>{x.value=p.data})})();const f=(p=1)=>{n.loading=!0,n.page=p,ce({page:n.page,limit:n.limit,...n.searchParam}).then(r=>{n.loading=!1,n.data=r.data.data,n.total=r.data.total,Q(n.page,n.limit,n.searchParam)}).catch(()=>{n.loading=!1})};f(A(n.searchParam).page);const v=g(null),P=g(null),V=p=>{P.value.show(p)},$=()=>{C.push("/shop/marketing/coupon/add")},L=p=>{C.push("/shop/marketing/coupon/edit?id="+p.id)},R=p=>{let r={id:p.id};v.value.setFormData(r),v.value.showDialog=!0},D=p=>{B.confirm(t("couponDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{de(p.id).then(()=>{f()}).catch(()=>{})})},N=p=>{B.confirm(t("couponColseTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{me(p.id).then(()=>{f()}).catch(()=>{})})},z=p=>{p&&(p.resetFields(),f())};return(p,r)=>{const u=X,w=Z,b=ee,I=te,U=ae,j=ne,T=le,d=oe,M=se,O=ie,q=re;return s(),c("div",fe,[a(T,{class:"box-card !border-none",shadow:"never"},{default:l(()=>[m("div",he,[m("span",ye,i(o(S)),1),a(u,{type:"primary",onClick:$},{default:l(()=>[_(i(o(t)("addCoupon")),1)]),_:1})]),a(T,{class:"box-card !border-none my-[20px] table-search-wrap",shadow:"never"},{default:l(()=>[a(j,{inline:!0,model:n.searchParam,ref_key:"searchFormRef",ref:E},{default:l(()=>[a(b,{label:o(t)("title"),prop:"title"},{default:l(()=>[a(w,{modelValue:n.searchParam.title,"onUpdate:modelValue":r[0]||(r[0]=e=>n.searchParam.title=e),modelModifiers:{trim:!0},placeholder:o(t)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(b,{label:o(t)("statusName"),prop:"status"},{default:l(()=>[a(U,{modelValue:n.searchParam.status,"onUpdate:modelValue":r[1]||(r[1]=e=>n.searchParam.status=e),clearable:"",class:"input-item"},{default:l(()=>[(s(!0),c(F,null,H(x.value,(e,h)=>(s(),y(I,{key:h,label:e,value:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(b,null,{default:l(()=>[a(u,{type:"primary",onClick:r[2]||(r[2]=e=>f())},{default:l(()=>[_(i(o(t)("search")),1)]),_:1}),a(u,{onClick:r[3]||(r[3]=e=>z(E.value))},{default:l(()=>[_(i(o(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),m("div",ge,[J((s(),y(M,{data:n.data,size:"large"},{empty:l(()=>[m("span",null,i(n.loading?"":o(t)("emptyData")),1)]),default:l(()=>[a(d,{prop:"title",label:o(t)("title"),"min-width":"130"},null,8,["label"]),a(d,{prop:"type_name",label:o(t)("type"),"min-width":"98"},null,8,["label"]),a(d,{prop:"price",label:o(t)("price"),"min-width":"100"},{default:l(({row:e})=>[m("span",null,"¥"+i(e.price),1)]),_:1},8,["label"]),a(d,{label:o(t)("receiveType"),"min-width":"130"},{default:l(({row:e})=>[e.receive_type==1?(s(),c("span",ve,"是")):(s(),c("span",be,"否"))]),_:1},8,["label"]),a(d,{label:o(t)("sumCount"),"min-width":"160"},{default:l(({row:e})=>[e.receive_type==1&&e.sum_count!="-1"?(s(),c("span",ke,i(e.remain_count||0)+" / "+i(e.sum_count||0),1)):(s(),c("span",Ce,"不限量"))]),_:1},8,["label"]),a(d,{label:o(t)("remainCount"),"min-width":"140"},{default:l(({row:e})=>[m("span",null,i(e.receive_count||0)+" / "+i(e.receive_use_count||0),1)]),_:1},8,["label"]),a(d,{label:o(t)("threshold"),"min-width":"130"},{default:l(({row:e})=>[e.min_condition_money=="0.00"?(s(),c("span",xe,"无门槛")):(s(),c("span",Ee,"满"+i(e.min_condition_money)+"元可用",1))]),_:1},8,["label"]),a(d,{label:o(t)("validType"),"min-width":"190"},{default:l(({row:e})=>[e.receive_type==1?(s(),c(F,{key:0},[e.valid_type==1?(s(),c("span",Pe," 领取之日起"+i(e.length||"")+" 天内有效",1)):(s(),c("span",Te," 使用截止时间至"+i(e.valid_end_time||""),1))],64)):(s(),c("span",Fe,"--"))]),_:1},8,["label"]),a(d,{label:o(t)("receiveTypeTime"),"min-width":"210"},{default:l(({row:e})=>[e.receive_type==1?(s(),c("div",Be,[parseInt(e.start_time)!=0&&parseInt(e.end_time)!=0?(s(),c("div",Se,[m("span",null,"开始时间："+i(e.start_time),1),m("span",null,"结束时间："+i(e.end_time),1)])):(s(),c("div",Ve,"不限时"))])):(s(),c("span",$e,"--"))]),_:1},8,["label"]),a(d,{prop:"status_name",label:o(t)("statusName"),"min-width":"98"},null,8,["label"]),a(d,{label:o(t)("operation"),fixed:"right",align:"right","min-width":"160"},{default:l(({row:e})=>[a(u,{type:"primary",link:"",onClick:h=>V(e)},{default:l(()=>[_(i(o(t)("spreadGoods")),1)]),_:2},1032,["onClick"]),e.status==0||e.status==1?(s(),y(u,{key:0,type:"primary",link:"",onClick:h=>L(e)},{default:l(()=>[_(i(o(t)("edit")),1)]),_:2},1032,["onClick"])):k("",!0),e.status!=1?(s(),y(u,{key:1,type:"primary",link:"",onClick:h=>D(e)},{default:l(()=>[_(i(o(t)("delete")),1)]),_:2},1032,["onClick"])):k("",!0),e.status==1?(s(),y(u,{key:2,type:"primary",link:"",onClick:h=>N(e)},{default:l(()=>[_(i(o(t)("close")),1)]),_:2},1032,["onClick"])):k("",!0),a(u,{type:"primary",link:"",onClick:h=>R(e)},{default:l(()=>[_(i(o(t)("receive")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[q,n.loading]]),m("div",Le,[a(O,{"current-page":n.page,"onUpdate:current-page":r[4]||(r[4]=e=>n.page=e),"page-size":n.limit,"onUpdate:page-size":r[5]||(r[5]=e=>n.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:n.total,onSizeChange:r[6]||(r[6]=e=>f()),onCurrentChange:f},null,8,["current-page","page-size","total"])])])]),_:1}),a(ue,{ref_key:"couponSpreadPopupRef",ref:P},null,512),a(_e,{ref_key:"couponCollectionRef",ref:v},null,512)])}}});export{dt as default};
