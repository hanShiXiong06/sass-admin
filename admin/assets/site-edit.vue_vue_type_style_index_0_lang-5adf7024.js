import{d as I,r as _,aJ as N,q as O,m as R,s as l,Q as M,h as g,v as V,w as o,a as w,e as s,i as E,t as f,u as r,R as j,c as G,F as T,T as $,ab as A,aC as J,L as Q,aS as X,M as Y,E as z,X as H,Y as K}from"./index-0e396751.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import{e as q,f as W,h as Z,i as ee}from"./site-368fa7aa.js";const te={class:"dialog-footer"},Ve=I({__name:"site-edit",emits:["complete"],setup(ae,{expose:P,emit:U}){const m=_(!1),n=_(!1),p=_(!1),v=_([]),h=async i=>{if(i!==""){p.value=!0;try{const e=await q({page:1,limit:20,keywords:i});v.value=e.data.data}catch(e){console.error("获取站点列表失败:",e)}finally{p.value=!1}}else v.value=[]},k=async()=>{p.value=!0;try{const i=await q({page:1,limit:20});v.value=i.data.data}catch(i){console.error("获取站点列表失败:",i)}finally{p.value=!1}};N(()=>{k()});const y={id:"",site_id:"",site_name:"",client:1,category_status:1,brand_status:1,label_group_status:1,label_status:1,service_status:1,price_status:1},t=O({...y}),S=_(),D=R(()=>({site_id:[{required:!0,message:l("siteIdPlaceholder"),trigger:"blur"}],site_name:[{required:!0,message:l("siteNamePlaceholder"),trigger:"blur"}],client:[{required:!0,message:l("clientPlaceholder"),trigger:"blur"}],category_status:[{required:!0,message:l("categoryStatusPlaceholder"),trigger:"blur"}],brand_status:[{required:!0,message:l("brandStatusPlaceholder"),trigger:"blur"}],label_group_status:[{required:!0,message:l("labelGroupStatusPlaceholder"),trigger:"blur"}],label_status:[{required:!0,message:l("labelStatusPlaceholder"),trigger:"blur"}],service_status:[{required:!0,message:l("serviceStatusPlaceholder"),trigger:"blur"}],price_status:[{required:!0,message:l("priceStatusPlaceholder"),trigger:"blur"}]})),F=async i=>{if(n.value||!i)return;const e=t.id?W:Z;await i.validate(async u=>{if(u){n.value=!0;try{await e(t),n.value=!1,m.value=!1,U("complete")}catch(b){console.error("保存失败:",b),n.value=!1}}})};return M(()=>t.site_id,i=>{if(i){const e=v.value.find(u=>u.site_id==i);e&&(t.site_name=e.site_name)}}),P({showDialog:m,setFormData:async(i=null)=>{if(Object.assign(t,y),n.value=!0,i)try{const e=await(await ee(i.id)).data;e&&Object.keys(t).forEach(u=>{e[u]!==void 0&&(t[u]=e[u])})}catch(e){console.error("获取站点信息失败:",e)}console.log(t),n.value=!1}}),(i,e)=>{const u=A,b=J,d=Q,c=X,L=Y,x=z,B=H,C=K;return g(),V(B,{modelValue:m.value,"onUpdate:modelValue":e[10]||(e[10]=a=>m.value=a),title:t.id?r(l)("updateSite"):r(l)("addSite"),width:"50%",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:o(()=>[w("span",te,[s(x,{onClick:e[8]||(e[8]=a=>m.value=!1)},{default:o(()=>[E(f(r(l)("cancel")),1)]),_:1}),s(x,{type:"primary",loading:n.value,onClick:e[9]||(e[9]=a=>F(S.value))},{default:o(()=>[E(f(r(l)("confirm")),1)]),_:1},8,["loading"])])]),default:o(()=>[j((g(),V(L,{model:t,"label-width":"120px",ref_key:"formRef",ref:S,rules:r(D),class:"page-form"},{default:o(()=>[s(d,{label:r(l)("siteId"),prop:"site_id"},{default:o(()=>[s(b,{disabled:!!t.id,modelValue:t.site_id,"onUpdate:modelValue":e[0]||(e[0]=a=>t.site_id=a),filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词搜索站点","remote-method":h,loading:p.value,class:"input-width"},{default:o(()=>[(g(!0),G(T,null,$(v.value,a=>(g(),V(u,{key:a.site_id,label:a.site_id+" - "+a.site_name,value:a.site_id},{default:o(()=>[w("span",null,f(a.site_id)+" - "+f(a.site_name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["disabled","modelValue","loading"])]),_:1},8,["label"]),s(d,{label:r(l)("client"),prop:"client"},{default:o(()=>[s(c,{modelValue:t.client,"onUpdate:modelValue":e[1]||(e[1]=a=>t.client=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(l)("categoryStatus"),prop:"category_status"},{default:o(()=>[s(c,{modelValue:t.category_status,"onUpdate:modelValue":e[2]||(e[2]=a=>t.category_status=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(l)("brandStatus"),prop:"brand_status"},{default:o(()=>[s(c,{modelValue:t.brand_status,"onUpdate:modelValue":e[3]||(e[3]=a=>t.brand_status=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(l)("labelGroupStatus"),prop:"label_group_status"},{default:o(()=>[s(c,{modelValue:t.label_group_status,"onUpdate:modelValue":e[4]||(e[4]=a=>t.label_group_status=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(l)("labelStatus"),prop:"label_status"},{default:o(()=>[s(c,{modelValue:t.label_status,"onUpdate:modelValue":e[5]||(e[5]=a=>t.label_status=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(l)("serviceStatus"),prop:"service_status"},{default:o(()=>[s(c,{modelValue:t.service_status,"onUpdate:modelValue":e[6]||(e[6]=a=>t.service_status=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1},8,["label"]),s(d,{label:r(l)("priceStatus"),prop:"price_status"},{default:o(()=>[s(c,{modelValue:t.price_status,"onUpdate:modelValue":e[7]||(e[7]=a=>t.price_status=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[C,n.value]])]),_:1},8,["modelValue","title"])}}});export{Ve as _};
