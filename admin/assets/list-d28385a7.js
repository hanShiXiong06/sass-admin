import{d as te,f as ne,y as le,r as d,q as oe,bO as ie,h as c,c as D,e as o,w as s,a as h,t as r,u as i,i as p,s as e,F as se,T as re,v,C as k,R as me,bP as ce,a5 as x,U as L,E as ue,K as de,L as pe,bR as _e,M as ge,a7 as fe,ax as he,ay as ve,av as be,ac as ye,ad as ke,W as Ce,Y as je}from"./index-0e396751.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                    *//* empty css                *//* empty css                *//* empty css                       *//* empty css                  */import"./el-form-item-4ed993c7.js";import{X as xe,Y as Te,Z as Ee,_ as De,$ as Me,a0 as Pe}from"./marketing-c0187315.js";import{_ as we}from"./detail.vue_vue_type_style_index_0_lang-e947979f.js";/* empty css                  *//* empty css                   *//* empty css                 *//* empty css                        *//* empty css               *//* empty css               */import"./member_head-d9fd7b2c.js";const Be={class:"main-container"},Ve={class:"flex justify-between items-center"},Fe={class:"text-page-title"},Se={key:0,class:"mb-[10px] flex items-center"},Le={class:"mt-[16px] flex justify-end"},da=te({__name:"list",setup($e){const M=ne(),P=le(),$=P.meta.title,_=d(!1),w=d(),a=oe({page:1,limit:10,total:0,loading:!1,data:[],searchParam:{create_time:[],manjian_name:"",status:P.query.status||""}}),b=d(),z=(l,t)=>{a.searchParam.status=l.props.name,b.value=l.props.name,m()},m=(l=1)=>{a.loading=!0,a.page=l,xe({page:a.page,limit:a.limit,...a.searchParam}).then(t=>{a.loading=!1,a.data=t.data.data,a.total=t.data.total,ce(a.page,a.limit,a.searchParam)}).catch(()=>{a.loading=!1})};m(ie(a.searchParam).page);const R=l=>{l&&(l.resetFields(),m())},N=()=>{M.push("/shop/marketing/manjian/edit")},B=d({});(()=>{Te().then(l=>{B.value=l.data})})();const U=l=>{M.push("/shop/marketing/manjian/edit?id="+l.manjian_id)},T=d(null),Y=l=>{let t={id:l};T.value.setFormData(t),T.value.showDialog=!0},C=d(),j=d(!1),A=l=>{j.value=!1,V.value.toggleAllSelection()},V=d(),g=d([]),H=l=>{g.value=l,C.value=!1,g.value.length>0&&g.value.length<a.data.length?j.value=!0:j.value=!1,g.value.length==a.data.length&&(C.value=!0)},I=l=>{x.confirm(e("closeTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{Ee(l).then(()=>{m()}).catch(()=>{})})},O=l=>{x.confirm(e("deleteTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{De(l).then(()=>{m()}).catch(()=>{})})},q=()=>{if(g.value.length==0){L({type:"warning",message:`${e("batchEmptySelectedActiveDeleteTips")}`});return}x.confirm(e("batchGoodsDeleteTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{if(_.value)return;_.value=!0;const l=[];g.value.forEach(t=>{l.push(t.manjian_id)}),Me({manjian_id:l}).then(()=>{m(),_.value=!1}).catch(()=>{_.value=!1})})},G=()=>{if(g.value.length==0){L({type:"warning",message:`${e("batchEmptySelectedActiveCloseTips")}`});return}x.confirm(e("batchGoodsCloseTips"),e("warning"),{confirmButtonText:e("confirm"),cancelButtonText:e("cancel"),type:"warning"}).then(()=>{if(_.value)return;_.value=!0;const l=[];g.value.forEach(t=>{l.push(t.manjian_id)}),Pe({manjian_id:l}).then(()=>{m(),_.value=!1}).catch(()=>{_.value=!1})})};return(l,t)=>{const u=ue,K=de,E=pe,W=_e,X=ge,F=fe,S=he,Z=ve,J=be,f=ye,Q=ke,ee=Ce,ae=je;return c(),D("div",Be,[o(F,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[h("div",Ve,[h("span",Fe,r(i($)),1),o(u,{type:"primary",onClick:N},{default:s(()=>[p(r(i(e)("addFullDiscountBonus")),1)]),_:1})]),o(F,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:s(()=>[o(X,{inline:!0,model:a.searchParam,ref_key:"searchFormRef",ref:w},{default:s(()=>[o(E,{label:i(e)("name"),prop:"manjian_name"},{default:s(()=>[o(K,{modelValue:a.searchParam.manjian_name,"onUpdate:modelValue":t[0]||(t[0]=n=>a.searchParam.manjian_name=n),modelModifiers:{trim:!0},placeholder:i(e)("namePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(E,null,{default:s(()=>[o(E,{label:i(e)("activityTime"),prop:"create_time"},{default:s(()=>[o(W,{modelValue:a.searchParam.create_time,"onUpdate:modelValue":t[1]||(t[1]=n=>a.searchParam.create_time=n),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":i(e)("startDate"),"end-placeholder":i(e)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),o(u,{type:"primary",onClick:t[2]||(t[2]=n=>m())},{default:s(()=>[p(r(i(e)("search")),1)]),_:1}),o(u,{onClick:t[3]||(t[3]=n=>R(w.value))},{default:s(()=>[p(r(i(e)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),h("div",null,[o(Z,{modelValue:a.searchParam.status,"onUpdate:modelValue":t[4]||(t[4]=n=>a.searchParam.status=n),class:"goods-tabs",onTabClick:z},{default:s(()=>[o(S,{label:i(e)("all"),name:""},null,8,["label"]),(c(!0),D(se,null,re(B.value,(n,y)=>(c(),v(S,{key:y,label:n,name:y},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),b.value?(c(),D("div",Se,[o(J,{modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=n=>C.value=n),size:"large",class:"px-[14px]",onChange:A,indeterminate:j.value},null,8,["modelValue","indeterminate"]),b.value==0||b.value==2||b.value==-1?(c(),v(u,{key:0,onClick:q,size:"small"},{default:s(()=>[p(r(i(e)("batchDelete")),1)]),_:1})):k("",!0),b.value==1?(c(),v(u,{key:1,onClick:G,size:"small"},{default:s(()=>[p(r(i(e)("batchClose")),1)]),_:1})):k("",!0)])):k("",!0),me((c(),v(Q,{data:a.data,size:"large",ref_key:"goodBankListTableRef",ref:V,onSelectionChange:H},{empty:s(()=>[h("span",null,r(a.loading?"":i(e)("emptyData")),1)]),default:s(()=>[o(f,{type:"selection",width:"55"}),o(f,{prop:"manjian_name",label:i(e)("name"),"min-width":"130"},null,8,["label"]),o(f,{prop:"status_name",label:i(e)("status"),"min-width":"130"},null,8,["label"]),o(f,{prop:"total_order_num",label:i(e)("activeOrderNum"),"min-width":"130"},null,8,["label"]),o(f,{prop:"total_order_money",label:i(e)("activeOrderMoney"),"min-width":"130"},null,8,["label"]),o(f,{prop:"total_member_num",label:i(e)("activeMemberNum"),"min-width":"130"},null,8,["label"]),o(f,{label:i(e)("activityTime"),"min-width":"150"},{default:s(({row:n})=>[h("div",null,[h("p",null,"开始："+r(n.start_time),1),h("p",null,"结束："+r(n.end_time),1)])]),_:1},8,["label"]),o(f,{label:i(e)("operation"),fixed:"right",align:"right","min-width":"120"},{default:s(({row:n})=>[n.status!="-1"||n.status!="2"?(c(),v(u,{key:0,type:"primary",link:"",onClick:y=>U(n)},{default:s(()=>[p(r(i(e)("edit")),1)]),_:2},1032,["onClick"])):k("",!0),o(u,{type:"primary",link:"",onClick:y=>Y(n.manjian_id)},{default:s(()=>[p(r(i(e)("detail")),1)]),_:2},1032,["onClick"]),n.status=="1"?(c(),v(u,{key:1,type:"primary",link:"",onClick:y=>I(n.manjian_id)},{default:s(()=>[p(r(i(e)("close")),1)]),_:2},1032,["onClick"])):k("",!0),n.status!="1"?(c(),v(u,{key:2,type:"primary",link:"",onClick:y=>O(n.manjian_id)},{default:s(()=>[p(r(i(e)("delete")),1)]),_:2},1032,["onClick"])):k("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[ae,a.loading]]),h("div",Le,[o(ee,{"current-page":a.page,"onUpdate:current-page":t[6]||(t[6]=n=>a.page=n),"page-size":a.limit,"onUpdate:page-size":t[7]||(t[7]=n=>a.limit=n),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:t[8]||(t[8]=n=>m()),onCurrentChange:m},null,8,["current-page","page-size","total"])])])]),_:1}),o(we,{ref_key:"manjianDetailDialog",ref:T},null,512)])}}});export{da as default};
