import{d as se,y as ne,f as ie,r as b,q as z,h as p,c as f,e,w as n,a as d,t as m,u as o,s as l,F as R,T as I,v as N,i as k,R as de,C as w,B as me,a3 as ce,a5 as pe,ab as _e,aC as ue,K as fe,L as he,bR as be,E as ye,M as ge,a7 as xe,ax as ve,ay as ke,ac as we,ad as Ce,aU as De,aa as Ve,W as Te,Y as Pe}from"./index-0e396751.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                    *//* empty css                        *//* empty css                    *//* empty css                *//* empty css                *//* empty css                  *//* empty css                       */import"./el-form-item-4ed993c7.js";import{_ as Ee,a as Se,b as Ne,d as Fe,c as Ue}from"./order-notes.vue_vue_type_style_index_0_lang-f14bc284.js";import{_ as Be}from"./order-detail.vue_vue_type_style_index_0_lang-52998c9c.js";import{_ as $e}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                  *//* empty css                   *//* empty css                  *//* empty css               *//* empty css               */const Me={class:"main-container"},Ye={class:"flex justify-between items-center"},ze={class:"text-page-title"},Re={class:"table-body min-h-[150px]"},Ie={key:0},Le={class:"flex items-center justify-between bg-[#f7f8fa] mt-[10px] border-[#e4e7ed] border-solid border-b-[1px] px-3 h-[35px] text-[12px] text-[#666]"},Oe={class:"ml-5"},je={key:0,class:"ml-5"},qe={class:"flex cursor-pointer"},Ae={class:"flex items-center min-w-[50px] mr-[10px]"},He=["src"],Ge={key:1,class:"w-[50px] h-[50px]",src:"",alt:""},Ke={class:"flex flex-col"},We={class:"max-w-[250px]"},Je={class:"multi-hidden text-[14px]"},Qe={class:"flex flex-col"},Xe={class:"text-[13px]"},Ze={class:"text-[13px] mt-[5px]"},et={class:"text-[14px]"},tt={class:"text-[14px]"},at={class:"flex flex-col"},lt=["onClick"],ot={class:"text-[14px]"},rt={key:0,class:"text-[14px]"},st={key:0,class:"text-[14px] min-h-[30px] leading-[30px] px-3 bg-[#fff0e5] text-[#ff7f5b]"},nt={class:"mr-[5px]"},it={class:"mt-[16px] flex justify-end"},dt=se({__name:"list",setup(mt){const C=ne(),L=ie(),O=C.meta.title,F=b(C.query.status||""),j=b([]),U=b([]),T=b(null);(async()=>{j.value=await(await Se()).data,U.value=await(await Ne()).data})();const t=z({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{search_type:"order_no",search_name:"",nickname:"",pay_type:"",status:C.query.status||"",create_time:[],pay_time:[],giftcard_id:C.query.giftcard_id}}),B=b(),y=z({}),P=b(null),D=b(!1),q=()=>{if(D.value){D.value=!1;for(const s in t.data)P.value[s].clearSelection(),delete y["order_"+t.data[s].order_id]}else{D.value=!0;for(const s in t.data){let a=!1;for(const _ in t.data[s].order_gift_card)t.data[s].order_gift_card[_].status==1&&(P.value[s].toggleRowSelection(t.data[s].order_gift_card[_],!0),a=!0);a&&(y["order_"+t.data[s].order_id]=ce(t.data[s]))}}},A=(s,a)=>{let _=!1,x=null;for(let u=0;u<t.data.length;u++)if(t.data[u].order_id==a.order_id){x=t.data[u];break}for(let u=0;u<s.length;u++)if(s[u].order_id==a.order_id){_=!0;break}_?y["order_"+a.order_id]=x:delete y["order_"+a.order_id]},H=(s,a)=>!0,h=(s=1)=>{t.loading=!0,t.page=s,Fe({page:t.page,limit:t.limit,...t.searchParam}).then(a=>{t.loading=!1,t.data=a.data.data.map(_=>(_.order_gift_card=[_],_)),t.total=a.data.total}).catch(()=>{t.loading=!1})};h();const G=s=>{t.searchParam.status=s,D.value=!1;for(let a in y)delete y[a];h()},K=s=>{s&&(s.resetFields(),h())},W=s=>{let a={id:s.order_id};T.value.setFormData(a),T.value.showDialog=!0},E=b(null),J=s=>{E.value.setFormData(s),E.value.showDialog=!0},Q=s=>{const a=L.resolve({path:"/member/detail",query:{id:s}});window.open(a.href,"_blank")},X=s=>{pe.confirm(l("orderCloseTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{Ue(s.order_id).then(()=>{h()})})};return(s,a)=>{const _=_e,x=ue,u=fe,g=he,$=be,v=ye,Z=ge,M=xe,V=ve,ee=ke,c=we,Y=Ce,te=De,ae=Ve,le=Te,oe=Pe;return p(),f("div",Me,[e(M,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[d("div",Ye,[d("span",ze,m(o(O)),1)]),e(M,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[e(Z,{inline:!0,model:t.searchParam,ref_key:"searchFormRef",ref:B},{default:n(()=>[e(g,{label:o(l)("orderInfo"),prop:"search_name"},{default:n(()=>[e(x,{modelValue:t.searchParam.search_type,"onUpdate:modelValue":a[0]||(a[0]=r=>t.searchParam.search_type=r),clearable:"",class:"input-item"},{default:n(()=>[e(_,{label:o(l)("orderNo"),value:"order_no"},null,8,["label"]),e(_,{label:o(l)("outTradeNo"),value:"out_trade_no"},null,8,["label"])]),_:1},8,["modelValue"]),e(u,{class:"input-item ml-3",modelValue:t.searchParam.search_name,"onUpdate:modelValue":a[1]||(a[1]=r=>t.searchParam.search_name=r),modelModifiers:{trim:!0},maxlength:"20"},null,8,["modelValue"])]),_:1},8,["label"]),e(g,{label:o(l)("memberInfo"),prop:"nickname"},{default:n(()=>[e(u,{class:"w-[200px]",modelValue:t.searchParam.nickname,"onUpdate:modelValue":a[2]||(a[2]=r=>t.searchParam.nickname=r),modelModifiers:{trim:!0},placeholder:o(l)("memberInfoPlaceholder"),maxlength:"20"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(g,{label:o(l)("payType"),prop:"pay_type"},{default:n(()=>[e(x,{modelValue:t.searchParam.pay_type,"onUpdate:modelValue":a[3]||(a[3]=r=>t.searchParam.pay_type=r),clearable:"",class:"input-item"},{default:n(()=>[(p(!0),f(R,null,I(U.value,(r,S)=>(p(),N(_,{key:S,label:r.name,value:r.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(g,{label:o(l)("createTime"),prop:"create_time"},{default:n(()=>[e($,{modelValue:t.searchParam.create_time,"onUpdate:modelValue":a[4]||(a[4]=r=>t.searchParam.create_time=r),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(l)("startDate"),"end-placeholder":o(l)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),e(g,{label:o(l)("payTime"),prop:"pay_time"},{default:n(()=>[e($,{modelValue:t.searchParam.pay_time,"onUpdate:modelValue":a[5]||(a[5]=r=>t.searchParam.pay_time=r),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(l)("startDate"),"end-placeholder":o(l)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),e(g,null,{default:n(()=>[e(v,{type:"primary",onClick:a[6]||(a[6]=r=>h())},{default:n(()=>[k(m(o(l)("search")),1)]),_:1}),e(v,{onClick:a[7]||(a[7]=r=>K(B.value))},{default:n(()=>[k(m(o(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ee,{modelValue:F.value,"onUpdate:modelValue":a[8]||(a[8]=r=>F.value=r),class:"demo-tabs",onTabChange:G},{default:n(()=>[e(V,{label:o(l)("all"),name:""},null,8,["label"]),e(V,{label:o(l)("toBePaid"),name:"1"},null,8,["label"]),e(V,{label:o(l)("completed"),name:"2"},null,8,["label"]),e(V,{label:o(l)("closed"),name:"-1"},null,8,["label"])]),_:1},8,["modelValue"]),d("div",null,[e(Y,{data:t.data,size:"large",class:"table-top",onSelectAll:q},{default:n(()=>[e(c,{type:"selection",width:"40"}),e(c,{label:o(l)("giftCard"),"min-width":"200"},null,8,["label"]),e(c,{label:o(l)("cardNumber"),"min-width":"120"},null,8,["label"]),e(c,{label:o(l)("cardRightType"),"min-width":"120"},null,8,["label"]),e(c,{label:o(l)("orderMoney"),"min-width":"120"},null,8,["label"]),e(c,{label:o(l)("buyInfo"),"min-width":"120"},null,8,["label"]),e(c,{label:o(l)("orderStatus"),"min-width":"100"},null,8,["label"]),e(c,{label:o(l)("payTime"),"min-width":"120"},null,8,["label"]),e(c,{label:o(l)("operation"),fixed:"right",align:"right","min-width":"120"},null,8,["label"])]),_:1},8,["data"]),de((p(),f("div",Re,[t.loading?w("",!0):(p(),f("div",Ie,[t.data.length?(p(!0),f(R,{key:0},I(t.data,(r,S)=>(p(),f("div",{key:S},[d("div",Le,[d("div",null,[d("span",null,m(o(l)("orderNo"))+"："+m(r.order_no),1),d("span",Oe,m(o(l)("createTime"))+"："+m(r.create_time),1),r.pay?(p(),f("span",je,m(o(l)("payType"))+"："+m(r.pay.type_name),1)):w("",!0)]),d("div",null,[e(v,{type:"primary",link:"",onClick:i=>W(r)},{default:n(()=>[k(m(o(l)("info")),1)]),_:2},1032,["onClick"]),e(v,{type:"primary",link:"",onClick:i=>J(r)},{default:n(()=>[k(m(o(l)("notes")),1)]),_:2},1032,["onClick"])])]),e(Y,{data:r.order_gift_card,size:"large","show-header":!1,ref_for:!0,ref_key:"multipleTable",ref:P,onSelect:A},{default:n(()=>[e(c,{type:"selection",width:"40",selectable:H}),e(c,{"min-width":"200"},{default:n(({row:i})=>[d("div",qe,[d("div",Ae,[i.card_cover?(p(),f("img",{key:0,class:"w-[50px] h-[50px]",src:o(me)(i.card_cover),alt:""},null,8,He)):(p(),f("img",Ge))]),d("div",Ke,[e(te,{class:"box-item",effect:"light",placement:"top"},{content:n(()=>[d("div",We,m(i.body),1)]),default:n(()=>[d("p",Je,m(i.body),1)]),_:2},1024)])])]),_:1}),e(c,{"min-width":"120"},{default:n(({row:i})=>[d("div",Qe,[d("span",Xe,"￥"+m(i.card_price),1),d("span",Ze,m(i.num)+m(o(l)("piece")),1)])]),_:1}),e(c,{"min-width":"120"},{default:n(({row:i})=>[d("span",et,m(i.card_right_type_name),1)]),_:1}),e(c,{"min-width":"120"},{default:n(({row:i})=>[d("span",tt,"￥"+m(i.order_money),1)]),_:1}),e(c,{"min-width":"120"},{default:n(({row:i})=>[d("div",at,[d("span",{class:"text-[12px] text-primary cursor-pointer",onClick:re=>Q(i.member.member_id)},m(i.member.nickname),9,lt)])]),_:1}),e(c,{"min-width":"100"},{default:n(({row:i})=>[d("span",ot,m(i.status_name),1)]),_:1}),e(c,{"min-width":"120"},{default:n(({row:i})=>[i.pay_time!=0?(p(),f("span",rt,m(i.pay_time),1)):w("",!0)]),_:1}),e(c,{align:"right","min-width":"120"},{default:n(({row:i})=>[i.status==1?(p(),N(v,{key:0,type:"primary",link:"",onClick:re=>X(i)},{default:n(()=>[k(m(o(l)("orderClose")),1)]),_:2},1032,["onClick"])):w("",!0)]),_:1})]),_:2},1032,["data"]),r.shop_remark?(p(),f("div",st,[d("span",nt,m(o(l)("notes"))+"：",1),d("span",null,m(r.shop_remark),1)])):w("",!0)]))),128)):(p(),N(ae,{key:1,"image-size":1,description:o(l)("emptyData")},null,8,["description"]))]))])),[[oe,t.loading]]),d("div",it,[e(le,{"current-page":t.page,"onUpdate:current-page":a[9]||(a[9]=r=>t.page=r),"page-size":t.limit,"onUpdate:page-size":a[10]||(a[10]=r=>t.limit=r),layout:"total, sizes, prev, pager, next, jumper",total:t.total,onSizeChange:a[11]||(a[11]=r=>h()),onCurrentChange:h},null,8,["current-page","page-size","total"])])])]),_:1}),e(Ee,{ref_key:"orderNotesDialog",ref:E,onComplete:h},null,512),e(Be,{ref_key:"orderDetailDialog",ref:T,onLoad:a[12]||(a[12]=r=>h())},null,512)])}}});const It=$e(dt,[["__scopeId","data-v-ab151371"]]);export{It as default};
