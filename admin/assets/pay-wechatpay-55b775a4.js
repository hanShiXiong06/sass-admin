import{d as L,r as u,aS as H,n as Q,l as W,q as t,aP as X,Q as Y,U as E,h as U,s as x,w as s,a as r,e as c,i as T,t as n,u as a,R as v,a0 as P,a3 as z,H as g,K as A,L as G,M as J,E as Z,X as ee,Y as te}from"./index-904cb7a2.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                */import{_ as le}from"./index.vue_vue_type_style_index_0_lang-51a9298e.js";import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                    */const ae={class:"form-tip"},oe={class:"form-tip"},ce={class:"input-width"},ie={class:"form-tip"},se={class:"input-width"},re={class:"form-tip"},ne={class:"input-width"},de={class:"input-width"},pe={class:"form-tip !leading-normal"},ue={class:"form-tip !leading-normal"},me={class:"form-tip !leading-normal"},_e={class:"dialog-footer"},ke=L({__name:"pay-wechatpay",emits:["complete"],setup(he,{expose:I,emit:C}){const m=u(!1),_=u(!0),h=u(""),b=u(""),f=u(null);H().then(o=>{h.value=o.data.wap_domain,b.value=o.data.service_domain});const w={type:"wechatpay",config:{mch_id:"",mch_secret_key:"",mch_secret_cert:"",mch_public_cert_path:"",wechat_public_cert_path:"",wechat_public_cert_id:""},channel:"",status:0,is_default:0},e=Q({...w}),D=u(),j=W(()=>({"config.mch_id":[{required:!0,message:t("mchIdPlaceholder"),trigger:"blur"}],"config.mch_secret_key":[{required:!0,message:t("mchSecretKeyPlaceholder"),trigger:"blur"}],"config.mch_secret_cert":[{required:!0,message:t("mchSecretCertPlaceholder"),trigger:"blur"}],"config.mch_public_cert_path":[{required:!0,message:t("mchPublicCertPathPlaceholder"),trigger:"blur"}]})),q=async o=>{_.value||!o||await o.validate(async l=>{l&&(C("complete",e),m.value=!1)})},K=()=>{Object.assign(e,w),f.value&&(Object.keys(e).forEach(o=>{f.value[o]!=null&&(e[o]=f.value[o])}),e.channel=f.value.redio_key.split("_")[0],e.status=Number(e.status)),C("complete",e),m.value=!1},M=async(o=null)=>{f.value=z(o),_.value=!0,Object.assign(e,w),o&&(Object.keys(e).forEach(l=>{o[l]!=null&&(e[l]=o[l])}),e.channel=o.redio_key.split("_")[0],e.status=Number(e.status)),_.value=!1},N=()=>{let o=!0;return(g.empty(e.config.mch_id)||g.empty(e.config.mch_secret_key)||g.empty(e.config.mch_secret_cert)||g.empty(e.config.mch_public_cert_path))&&(o=!1),o},{copy:$,isSupported:B,copied:k}=X(),y=o=>{if(!B.value){E({message:t("notSupportCopy"),type:"warning"});return}$(o)};return Y(k,()=>{k.value&&E({message:t("copySuccess"),type:"success"})}),I({showDialog:m,setFormData:M,enableVerify:N}),(o,l)=>{const p=A,d=G,V=le,F=J,S=Z,O=ee,R=te;return U(),x(O,{modelValue:m.value,"onUpdate:modelValue":l[10]||(l[10]=i=>m.value=i),title:a(t)("updateWechat"),width:"500px","destroy-on-close":!0},{footer:s(()=>[r("span",_e,[c(S,{onClick:K},{default:s(()=>[T(n(a(t)("cancel")),1)]),_:1}),c(S,{type:"primary",loading:_.value,onClick:l[9]||(l[9]=i=>q(D.value))},{default:s(()=>[T(n(a(t)("confirm")),1)]),_:1},8,["loading"])])]),default:s(()=>[v((U(),x(F,{model:e,"label-width":"140px",ref_key:"formRef",ref:D,rules:a(j),class:"page-form"},{default:s(()=>[c(d,{label:a(t)("mchId"),prop:"config.mch_id"},{default:s(()=>[c(p,{modelValue:e.config.mch_id,"onUpdate:modelValue":l[0]||(l[0]=i=>e.config.mch_id=i),modelModifiers:{trim:!0},placeholder:a(t)("mchIdPlaceholder"),class:"input-width",maxlength:"32","show-word-limit":"",clearable:""},null,8,["modelValue","placeholder"]),r("div",ae,n(a(t)("mchIdTips")),1)]),_:1},8,["label"]),c(d,{label:a(t)("mchSecretKey"),prop:"config.mch_secret_key"},{default:s(()=>[c(p,{modelValue:e.config.mch_secret_key,"onUpdate:modelValue":l[1]||(l[1]=i=>e.config.mch_secret_key=i),modelModifiers:{trim:!0},placeholder:a(t)("mchSecretKeyPlaceholder"),class:"input-width",maxlength:"32","show-word-limit":"",clearable:""},null,8,["modelValue","placeholder"]),r("div",oe,n(a(t)("mchSecretKeyTips")),1)]),_:1},8,["label"]),c(d,{label:a(t)("mchSecretCert"),prop:"config.mch_secret_cert"},{default:s(()=>[r("div",ce,[c(V,{modelValue:e.config.mch_secret_cert,"onUpdate:modelValue":l[2]||(l[2]=i=>e.config.mch_secret_cert=i),api:"sys/document/wechat"},null,8,["modelValue"])]),r("div",ie,n(a(t)("mchSecretCertTips")),1)]),_:1},8,["label"]),c(d,{label:a(t)("mchPublicCertPath"),prop:"config.mch_public_cert_path"},{default:s(()=>[r("div",se,[c(V,{modelValue:e.config.mch_public_cert_path,"onUpdate:modelValue":l[3]||(l[3]=i=>e.config.mch_public_cert_path=i),api:"sys/document/wechat"},null,8,["modelValue"])]),r("div",re,n(a(t)("mchPublicCertPathTips")),1)]),_:1},8,["label"]),c(d,{label:a(t)("wechatpayPublicCert"),prop:"config.wechat_public_cert_path"},{default:s(()=>[r("div",ne,[c(V,{modelValue:e.config.wechat_public_cert_path,"onUpdate:modelValue":l[4]||(l[4]=i=>e.config.wechat_public_cert_path=i),api:"sys/document/wechat"},null,8,["modelValue"])])]),_:1},8,["label"]),c(d,{label:a(t)("wechatpayPublicCertId"),prop:"config.wechat_public_cert_id"},{default:s(()=>[r("div",de,[c(p,{modelValue:e.config.wechat_public_cert_id,"onUpdate:modelValue":l[5]||(l[5]=i=>e.config.wechat_public_cert_id=i),modelModifiers:{trim:!0},placeholder:"",class:"input-width","show-word-limit":"",clearable:""},null,8,["modelValue"])])]),_:1},8,["label"]),v(c(d,{label:a(t)("jsapiDir")},{default:s(()=>[c(p,{"model-value":h.value+"/",placeholder:"Please input",class:"input-width",readonly:!0,disabled:!0},{append:s(()=>[r("div",{class:"cursor-pointer",onClick:l[6]||(l[6]=i=>y(h.value+"/"))},n(a(t)("copy")),1)]),_:1},8,["model-value"]),r("div",pe,n(a(t)("jsapiDirTips")),1)]),_:1},8,["label"]),[[P,e.channel=="wechat"||e.channel=="weapp"]]),v(c(d,{label:a(t)("h5Domain")},{default:s(()=>[c(p,{"model-value":h.value.replace("http://","").replace("https://",""),placeholder:"Please input",class:"input-width",readonly:!0,disabled:!0},{append:s(()=>[r("div",{class:"cursor-pointer",onClick:l[7]||(l[7]=i=>y(h.value.replace("http://","").replace("https://","")))},n(a(t)("copy")),1)]),_:1},8,["model-value"]),r("div",ue,n(a(t)("h5DomainTips")),1)]),_:1},8,["label"]),[[P,e.channel=="h5"]]),v(c(d,{label:a(t)("nativeDomain")},{default:s(()=>[c(p,{"model-value":b.value,placeholder:"Please input",class:"input-width",readonly:!0,disabled:!0},{append:s(()=>[r("div",{class:"cursor-pointer",onClick:l[8]||(l[8]=i=>y(b.value))},n(a(t)("copy")),1)]),_:1},8,["model-value"]),r("div",me,n(a(t)("nativeDomainTips")),1)]),_:1},8,["label"]),[[P,e.channel=="pc"]])]),_:1},8,["model","rules"])),[[R,_.value]])]),_:1},8,["modelValue","title"])}}});export{ke as default};
