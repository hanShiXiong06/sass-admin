import{d as Y,y as Q,r as d,q as X,h as _,c as C,e as n,w as o,a as i,t as c,u as s,s as l,F as Z,T as ee,v as E,i as v,R as te,B as ae,a5 as z,U as le,K as ne,L as se,ab as oe,aC as re,E as ie,M as ce,a7 as pe,ax as me,ay as ue,av as de,ac as _e,J as fe,ak as ge,ad as he,W as ve,Y as be}from"./index-0e396751.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        *//* empty css                        *//* empty css                    *//* empty css                *//* empty css                *//* empty css                  */import"./el-form-item-4ed993c7.js";import{_ as S}from"./default_img-44957769.js";import{b as ye,a as xe,t as F}from"./treasure-315db2bb.js";const Te={class:"main-container"},ke={class:"flex justify-between items-center"},Ce={class:"text-page-title"},Ee={class:"mt-[10px]"},Pe={class:"mb-[10px] flex items-center"},we={class:"flex items-center"},Ve={class:"min-w-[70px] h-[70px] flex items-center justify-center"},je=i("div",{class:"image-slot"},[i("img",{class:"w-[70px] h-[70px]",src:S})],-1),Be={key:1,class:"w-[70px] h-[70px]",src:S,fit:"contain"},ze={class:"ml-2 flex flex-col items-start"},Fe=["title"],Se={class:"text-primary text-[12px]"},Ie={class:"mt-[16px] flex justify-end"},ot=Y({__name:"list",setup(Le){const I=Q().meta.title,b=d(!1),t=X({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{keyword:"",relate_type:"",select_type:"all"}}),p=(r=1)=>{t.loading=!0,t.page=r,ye({page:t.page,limit:t.limit,...t.searchParam}).then(e=>{t.loading=!1,t.data=e.data.data,t.total=e.data.total,m.value=[]}).catch(()=>{t.loading=!1})},P=d(),f=d([]);(()=>{xe().then(r=>{const e=r.data;if(e){f.value=[];for(const u in e){const g={value:u,label:e[u]};f.value.push(g)}f.value.length&&(t.searchParam.relate_type=f.value[0].value),p()}})})();const L=(r,e)=>{t.searchParam.select_type=r.props.name,p()},y=d(),x=d(!1),N=r=>{x.value=!1,w.value.toggleAllSelection()},w=d(),m=d([]),U=r=>{m.value=r,y.value=!1,m.value.length>0&&m.value.length<t.data.length?x.value=!0:x.value=!1,m.value.length==t.data.length&&t.data.length&&m.value.length&&(y.value=!0)},$=(r,e)=>{z.confirm(e?l("participateTip"):l("offParticipateTip"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{b.value||(b.value=!0,F({relate_ids:[r.relate_id],relate_type:t.searchParam.relate_type,is_join:e}).then(u=>{b.value=!1,p()}).catch(()=>{b.value=!1}))}).catch(()=>{})},V=r=>{if(m.value.length==0){le({type:"warning",message:`${l("batchEmptySelectedGoodsTips")}`});return}const e=[];m.value.forEach(u=>{e.push(u.relate_id)}),z.confirm(r?l("participateTip"):l("offParticipateTip"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{F({relate_ids:e,relate_type:t.searchParam.relate_type,is_join:r}).then(u=>{p()})}).catch(()=>{})},R=r=>{r&&(r.resetFields(),p())};return(r,e)=>{const u=ne,g=se,D=oe,J=re,T=ie,M=ce,j=pe,k=me,q=ue,A=de,h=_e,G=fe,H=ge,K=he,O=ve,W=be;return _(),C("div",Te,[n(j,{class:"box-card !border-none",shadow:"never"},{default:o(()=>[i("div",ke,[i("span",Ce,c(s(I)),1)]),n(j,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:o(()=>[n(M,{inline:!0,model:t.searchParam,ref_key:"searchFormRef",ref:P},{default:o(()=>[n(g,{label:s(l)("treasureName"),prop:"keyword"},{default:o(()=>[n(u,{modelValue:t.searchParam.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>t.searchParam.keyword=a),modelModifiers:{trim:!0},placeholder:s(l)("treasureNamePlaceholder"),maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(g,{label:s(l)("relateType")},{default:o(()=>[n(J,{modelValue:t.searchParam.relate_type,"onUpdate:modelValue":e[1]||(e[1]=a=>t.searchParam.relate_type=a),placeholder:s(l)("relateTypePlaceholder")},{default:o(()=>[(_(!0),C(Z,null,ee(f.value,(a,B)=>(_(),E(D,{key:B,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(g,null,{default:o(()=>[n(T,{type:"primary",onClick:e[2]||(e[2]=a=>p())},{default:o(()=>[v(c(s(l)("search")),1)]),_:1}),n(T,{onClick:e[3]||(e[3]=a=>R(P.value))},{default:o(()=>[v(c(s(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),i("div",Ee,[n(q,{modelValue:t.searchParam.select_type,"onUpdate:modelValue":e[4]||(e[4]=a=>t.searchParam.select_type=a),onTabClick:L},{default:o(()=>[n(k,{label:s(l)("all"),name:"all"},null,8,["label"]),n(k,{label:s(l)("selected"),name:"selected"},null,8,["label"]),n(k,{label:s(l)("unselected"),name:"unselected"},null,8,["label"])]),_:1},8,["modelValue"]),i("div",Pe,[n(A,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=a=>y.value=a),size:"large",class:"px-[14px]",onChange:N,indeterminate:x.value},null,8,["modelValue","indeterminate"]),n(T,{onClick:e[6]||(e[6]=a=>V(1)),size:"small"},{default:o(()=>[v(c(s(l)("join")),1)]),_:1}),n(T,{onClick:e[7]||(e[7]=a=>V(0)),size:"small"},{default:o(()=>[v(c(s(l)("notJoin")),1)]),_:1})]),te((_(),E(K,{data:t.data,size:"large",ref_key:"treasureListTableRef",ref:w,onSelectionChange:U},{empty:o(()=>[i("span",null,c(t.loading?"":s(l)("emptyData")),1)]),default:o(()=>[n(h,{type:"selection",width:"55"}),n(h,{label:s(l)("treasureInfo"),"min-width":"300"},{default:o(({row:a})=>[i("div",we,[i("div",Ve,[a.treasure_image?(_(),E(G,{key:0,class:"w-[70px] h-[70px]",src:s(ae)(a.treasure_image),fit:"contain"},{error:o(()=>[je]),_:2},1032,["src"])):(_(),C("img",Be))]),i("div",ze,[i("span",{title:a.treasure_name,class:"multi-hidden"},c(a.treasure_name),9,Fe),i("span",Se,c(a.treasure_sub_name),1)])])]),_:1},8,["label"]),n(h,{prop:"relate_type_name",label:s(l)("relateTypeName"),"min-width":"120"},null,8,["label"]),n(h,{prop:"treasure_price",label:s(l)("treasurePrice"),"min-width":"120"},null,8,["label"]),n(h,{label:s(l)("isJoin"),"min-width":"120"},{default:o(({row:a})=>[n(H,{class:"cursor-pointer",type:a.is_join?"success":"danger",onClick:B=>$(a,a.is_join?0:1)},{default:o(()=>[v(c(a.is_join?s(l)("selected"):s(l)("unselected")),1)]),_:2},1032,["type","onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[W,t.loading]]),i("div",Ie,[n(O,{"current-page":t.page,"onUpdate:current-page":e[8]||(e[8]=a=>t.page=a),"page-size":t.limit,"onUpdate:page-size":e[9]||(e[9]=a=>t.limit=a),layout:"total, sizes, prev, pager, next, jumper",total:t.total,onSizeChange:e[10]||(e[10]=a=>p()),onCurrentChange:p},null,8,["current-page","page-size","total"])])])]),_:1})])}}});export{ot as default};
